---
title: "DS notcorr_kmdclust3"
author: "SVA"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  html_document:
    css: "styles.css"
    code_folding: hide
    df_print: paged
    toc: yes
    toc_depth: 4
    toc_float:
      collapsed: no
  word_document:
    toc: yes
    toc_depth: '4'
editor_options:
  chunk_output_type: inline
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  include = TRUE,
  message = FALSE, 
  warning = FALSE
)

rm(list=ls())
source("functions.R")
library("ARTool")
```
<script>
function addClassToTitle(containerId, className) {
  // Находим контейнер по id
  var container = document.getElementById(containerId);
  if (!container) {
    console.warn('Контейнер с id "' + containerId + '" не найден.');
    return;
  }

  // Добавляем класс к найденному h3
  container.classList.add(className);
}
</script>


```{r}
load("./data/envs/4_cluster_analysis/df.spd.male.RData")
df$gender <- factor(df$gender, labels = "M")
# df <- df.spd[df.spd$gender == "M", ]
```

```{r}
sign_differences <- vector()
```


# Описательные статистики

### notcorr_kmdclust3 {.tabset .tabset-fade .tabset-pills}

#### Table
```{r}
table(df$notcorr_kmdclust3)
```

#### Barplot
```{r}
ggplot(df, aes(notcorr_kmdclust3, fill=notcorr_kmdclust3)) + geom_bar()
```




















### ratio {.tabset .tabset-fade .tabset-pills}
**ratio**

#### Tables

Распределение по переменной "ratio"

```{r}
table(df$ratio, df$notcorr_kmdclust3)
```







### gender {.tabset .tabset-fade .tabset-pills}
**Пол респондента**

#### Tables

Распределение по переменной "gender"

```{r}
table(df$gender, df$notcorr_kmdclust3)
```






### time_total {.tabset .tabset-fade .tabset-pills}
**Общее время выполнения**

#### Descriptive stat

```{r}
describeBy(time_total ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "time_total"
plot_list <- draw_plots_continuous_by_group(df, var = time_total, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Общее время выполнения", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$time_total);print(st)
check_normal_distribution(st)
ks <- ks.test(df$time_total, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(time_total)$statistic,
          p.value = shapiro.test(time_total)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = time_total)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - time_total", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$time_total)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$time_total, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$time_total, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "time_total")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('time_total', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=time_total, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### velocity_mean {.tabset .tabset-fade .tabset-pills}
**Средняя гармоническая скорость**

#### Descriptive stat

```{r}
describeBy(velocity_mean ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "velocity_mean"
plot_list <- draw_plots_continuous_by_group(df, var = velocity_mean, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Средняя гармоническая скорость", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$velocity_mean);print(st)
check_normal_distribution(st)
ks <- ks.test(df$velocity_mean, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(velocity_mean)$statistic,
          p.value = shapiro.test(velocity_mean)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = velocity_mean)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - velocity_mean", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$velocity_mean)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$velocity_mean, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$velocity_mean, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "velocity_mean")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('velocity_mean', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=velocity_mean, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### missings_distance {.tabset .tabset-fade .tabset-pills}
**Расстояние промахов от центра мишеней, пикс.**

#### Descriptive stat

```{r}
describeBy(missings_distance ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "missings_distance"
plot_list <- draw_plots_continuous_by_group(df, var = missings_distance, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Расстояние промахов от центра мишеней, пикс.", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$missings_distance);print(st)
check_normal_distribution(st)
ks <- ks.test(df$missings_distance, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(missings_distance)$statistic,
          p.value = shapiro.test(missings_distance)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = missings_distance)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - missings_distance", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$missings_distance)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$missings_distance, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$missings_distance, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "missings_distance")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('missings_distance', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=missings_distance, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### distance_total {.tabset .tabset-fade .tabset-pills}
**Общая амплитуда**

#### Descriptive stat

```{r}
describeBy(distance_total ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "distance_total"
plot_list <- draw_plots_continuous_by_group(df, var = distance_total, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Общая амплитуда", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$distance_total);print(st)
check_normal_distribution(st)
ks <- ks.test(df$distance_total, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(distance_total)$statistic,
          p.value = shapiro.test(distance_total)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = distance_total)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - distance_total", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$distance_total)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$distance_total, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$distance_total, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "distance_total")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('distance_total', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=distance_total, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### pause_total {.tabset .tabset-fade .tabset-pills}
**Общее время пауз**

#### Descriptive stat

```{r}
describeBy(pause_total ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "pause_total"
plot_list <- draw_plots_continuous_by_group(df, var = pause_total, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Общее время пауз", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$pause_total);print(st)
check_normal_distribution(st)
ks <- ks.test(df$pause_total, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(pause_total)$statistic,
          p.value = shapiro.test(pause_total)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = pause_total)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - pause_total", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$pause_total)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$pause_total, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$pause_total, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "pause_total")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('pause_total', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=pause_total, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### time_total {.tabset .tabset-fade .tabset-pills}
**Общее время выполнения**

#### Descriptive stat

```{r}
describeBy(time_total ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "time_total"
plot_list <- draw_plots_continuous_by_group(df, var = time_total, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Общее время выполнения", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$time_total);print(st)
check_normal_distribution(st)
ks <- ks.test(df$time_total, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(time_total)$statistic,
          p.value = shapiro.test(time_total)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = time_total)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - time_total", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$time_total)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$time_total, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$time_total, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "time_total")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('time_total', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=time_total, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### time_mean {.tabset .tabset-fade .tabset-pills}
**Среднее время на клик**

#### Descriptive stat

```{r}
describeBy(time_mean ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "time_mean"
plot_list <- draw_plots_continuous_by_group(df, var = time_mean, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Среднее время на клик", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$time_mean);print(st)
check_normal_distribution(st)
ks <- ks.test(df$time_mean, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(time_mean)$statistic,
          p.value = shapiro.test(time_mean)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = time_mean)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - time_mean", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$time_mean)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$time_mean, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$time_mean, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "time_mean")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('time_mean', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=time_mean, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### time_sd {.tabset .tabset-fade .tabset-pills}
**Стандартное отклонение времени на клик**

#### Descriptive stat

```{r}
describeBy(time_sd ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "time_sd"
plot_list <- draw_plots_continuous_by_group(df, var = time_sd, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Стандартное отклонение времени на клик", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$time_sd);print(st)
check_normal_distribution(st)
ks <- ks.test(df$time_sd, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(time_sd)$statistic,
          p.value = shapiro.test(time_sd)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = time_sd)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - time_sd", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$time_sd)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$time_sd, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$time_sd, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "time_sd")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('time_sd', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=time_sd, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### time_median {.tabset .tabset-fade .tabset-pills}
**Медианное время на клик**

#### Descriptive stat

```{r}
describeBy(time_median ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "time_median"
plot_list <- draw_plots_continuous_by_group(df, var = time_median, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Медианное время на клик", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$time_median);print(st)
check_normal_distribution(st)
ks <- ks.test(df$time_median, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(time_median)$statistic,
          p.value = shapiro.test(time_median)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = time_median)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - time_median", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$time_median)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$time_median, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$time_median, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "time_median")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('time_median', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=time_median, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### time_trimmed {.tabset .tabset-fade .tabset-pills}
**Усеченное среднее времени на клик**

#### Descriptive stat

```{r}
describeBy(time_trimmed ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "time_trimmed"
plot_list <- draw_plots_continuous_by_group(df, var = time_trimmed, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Усеченное среднее времени на клик", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$time_trimmed);print(st)
check_normal_distribution(st)
ks <- ks.test(df$time_trimmed, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(time_trimmed)$statistic,
          p.value = shapiro.test(time_trimmed)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = time_trimmed)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - time_trimmed", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$time_trimmed)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$time_trimmed, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$time_trimmed, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "time_trimmed")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('time_trimmed', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=time_trimmed, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### time_mad {.tabset .tabset-fade .tabset-pills}
**Среднее Абсолютное Отклонение времени на клик**

#### Descriptive stat

```{r}
describeBy(time_mad ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "time_mad"
plot_list <- draw_plots_continuous_by_group(df, var = time_mad, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Среднее Абсолютное Отклонение времени на клик", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$time_mad);print(st)
check_normal_distribution(st)
ks <- ks.test(df$time_mad, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(time_mad)$statistic,
          p.value = shapiro.test(time_mad)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = time_mad)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - time_mad", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$time_mad)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$time_mad, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$time_mad, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "time_mad")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('time_mad', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=time_mad, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### time_min {.tabset .tabset-fade .tabset-pills}
**Минимальное время клика**

#### Descriptive stat

```{r}
describeBy(time_min ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "time_min"
plot_list <- draw_plots_continuous_by_group(df, var = time_min, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Минимальное время клика", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$time_min);print(st)
check_normal_distribution(st)
ks <- ks.test(df$time_min, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(time_min)$statistic,
          p.value = shapiro.test(time_min)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = time_min)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - time_min", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$time_min)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$time_min, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$time_min, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "time_min")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('time_min', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=time_min, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### time_max {.tabset .tabset-fade .tabset-pills}
**Максимальное время клика**

#### Descriptive stat

```{r}
describeBy(time_max ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "time_max"
plot_list <- draw_plots_continuous_by_group(df, var = time_max, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Максимальное время клика", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$time_max);print(st)
check_normal_distribution(st)
ks <- ks.test(df$time_max, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(time_max)$statistic,
          p.value = shapiro.test(time_max)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = time_max)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - time_max", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$time_max)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$time_max, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$time_max, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "time_max")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('time_max', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=time_max, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### time_range {.tabset .tabset-fade .tabset-pills}
**Размах времени на клик**

#### Descriptive stat

```{r}
describeBy(time_range ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "time_range"
plot_list <- draw_plots_continuous_by_group(df, var = time_range, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Размах времени на клик", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$time_range);print(st)
check_normal_distribution(st)
ks <- ks.test(df$time_range, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(time_range)$statistic,
          p.value = shapiro.test(time_range)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = time_range)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - time_range", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$time_range)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$time_range, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$time_range, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "time_range")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('time_range', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=time_range, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### time_skew {.tabset .tabset-fade .tabset-pills}
**Коэффициент асимметрии времени выполнения**

#### Descriptive stat

```{r}
describeBy(time_skew ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "time_skew"
plot_list <- draw_plots_continuous_by_group(df, var = time_skew, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Коэффициент асимметрии времени выполнения", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$time_skew);print(st)
check_normal_distribution(st)
ks <- ks.test(df$time_skew, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(time_skew)$statistic,
          p.value = shapiro.test(time_skew)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = time_skew)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - time_skew", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$time_skew)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$time_skew, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$time_skew, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "time_skew")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('time_skew', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=time_skew, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### time_kurtosis {.tabset .tabset-fade .tabset-pills}
**Эксцесс времени выполнения**

#### Descriptive stat

```{r}
describeBy(time_kurtosis ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "time_kurtosis"
plot_list <- draw_plots_continuous_by_group(df, var = time_kurtosis, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Эксцесс времени выполнения", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$time_kurtosis);print(st)
check_normal_distribution(st)
ks <- ks.test(df$time_kurtosis, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(time_kurtosis)$statistic,
          p.value = shapiro.test(time_kurtosis)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = time_kurtosis)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - time_kurtosis", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$time_kurtosis)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$time_kurtosis, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$time_kurtosis, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "time_kurtosis")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('time_kurtosis', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=time_kurtosis, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### time_se {.tabset .tabset-fade .tabset-pills}
**Стандартная ошибка среднего времени выполнения**

#### Descriptive stat

```{r}
describeBy(time_se ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "time_se"
plot_list <- draw_plots_continuous_by_group(df, var = time_se, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Стандартная ошибка среднего времени выполнения", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$time_se);print(st)
check_normal_distribution(st)
ks <- ks.test(df$time_se, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(time_se)$statistic,
          p.value = shapiro.test(time_se)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = time_se)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - time_se", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$time_se)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$time_se, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$time_se, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "time_se")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('time_se', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=time_se, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### time_q0.25 {.tabset .tabset-fade .tabset-pills}
**Нижний квартиль времени выполнения**

#### Descriptive stat

```{r}
describeBy(time_q0.25 ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "time_q0.25"
plot_list <- draw_plots_continuous_by_group(df, var = time_q0.25, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Нижний квартиль времени выполнения", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$time_q0.25);print(st)
check_normal_distribution(st)
ks <- ks.test(df$time_q0.25, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(time_q0.25)$statistic,
          p.value = shapiro.test(time_q0.25)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = time_q0.25)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - time_q0.25", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$time_q0.25)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$time_q0.25, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$time_q0.25, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "time_q0.25")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('time_q0.25', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=time_q0.25, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### time_q0.75 {.tabset .tabset-fade .tabset-pills}
**Верхний квартиль времени выполнения**

#### Descriptive stat

```{r}
describeBy(time_q0.75 ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "time_q0.75"
plot_list <- draw_plots_continuous_by_group(df, var = time_q0.75, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Верхний квартиль времени выполнения", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$time_q0.75);print(st)
check_normal_distribution(st)
ks <- ks.test(df$time_q0.75, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(time_q0.75)$statistic,
          p.value = shapiro.test(time_q0.75)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = time_q0.75)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - time_q0.75", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$time_q0.75)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$time_q0.75, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$time_q0.75, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "time_q0.75")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('time_q0.75', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=time_q0.75, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### time_trend {.tabset .tabset-fade .tabset-pills}
**Линейный тренд времени выполнения**

#### Descriptive stat

```{r}
describeBy(time_trend ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "time_trend"
plot_list <- draw_plots_continuous_by_group(df, var = time_trend, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Линейный тренд времени выполнения", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$time_trend);print(st)
check_normal_distribution(st)
ks <- ks.test(df$time_trend, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(time_trend)$statistic,
          p.value = shapiro.test(time_trend)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = time_trend)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - time_trend", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$time_trend)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$time_trend, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$time_trend, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "time_trend")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('time_trend', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=time_trend, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### fitts_a {.tabset .tabset-fade .tabset-pills}
**Коэффициент a в формуле Фиттса**

#### Descriptive stat

```{r}
describeBy(fitts_a ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "fitts_a"
plot_list <- draw_plots_continuous_by_group(df, var = fitts_a, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Коэффициент a в формуле Фиттса", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$fitts_a);print(st)
check_normal_distribution(st)
ks <- ks.test(df$fitts_a, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(fitts_a)$statistic,
          p.value = shapiro.test(fitts_a)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = fitts_a)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - fitts_a", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$fitts_a)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$fitts_a, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$fitts_a, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "fitts_a")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('fitts_a', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=fitts_a, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### fitts_b {.tabset .tabset-fade .tabset-pills}
**Коэффициент b в формуле Фиттса**

#### Descriptive stat

```{r}
describeBy(fitts_b ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "fitts_b"
plot_list <- draw_plots_continuous_by_group(df, var = fitts_b, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Коэффициент b в формуле Фиттса", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$fitts_b);print(st)
check_normal_distribution(st)
ks <- ks.test(df$fitts_b, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(fitts_b)$statistic,
          p.value = shapiro.test(fitts_b)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = fitts_b)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - fitts_b", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$fitts_b)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$fitts_b, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$fitts_b, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "fitts_b")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('fitts_b', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=fitts_b, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### distance_total {.tabset .tabset-fade .tabset-pills}
**Общая амплитуда**

#### Descriptive stat

```{r}
describeBy(distance_total ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "distance_total"
plot_list <- draw_plots_continuous_by_group(df, var = distance_total, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Общая амплитуда", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$distance_total);print(st)
check_normal_distribution(st)
ks <- ks.test(df$distance_total, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(distance_total)$statistic,
          p.value = shapiro.test(distance_total)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = distance_total)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - distance_total", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$distance_total)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$distance_total, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$distance_total, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "distance_total")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('distance_total', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=distance_total, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### distance_mean {.tabset .tabset-fade .tabset-pills}
**Средняя амплитуда на клик**

#### Descriptive stat

```{r}
describeBy(distance_mean ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "distance_mean"
plot_list <- draw_plots_continuous_by_group(df, var = distance_mean, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Средняя амплитуда на клик", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$distance_mean);print(st)
check_normal_distribution(st)
ks <- ks.test(df$distance_mean, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(distance_mean)$statistic,
          p.value = shapiro.test(distance_mean)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = distance_mean)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - distance_mean", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$distance_mean)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$distance_mean, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$distance_mean, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "distance_mean")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('distance_mean', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=distance_mean, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### distance_sd {.tabset .tabset-fade .tabset-pills}
**Стандартное отклонение амплитуда на клик**

#### Descriptive stat

```{r}
describeBy(distance_sd ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "distance_sd"
plot_list <- draw_plots_continuous_by_group(df, var = distance_sd, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Стандартное отклонение амплитуда на клик", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$distance_sd);print(st)
check_normal_distribution(st)
ks <- ks.test(df$distance_sd, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(distance_sd)$statistic,
          p.value = shapiro.test(distance_sd)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = distance_sd)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - distance_sd", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$distance_sd)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$distance_sd, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$distance_sd, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "distance_sd")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('distance_sd', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=distance_sd, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### distance_median {.tabset .tabset-fade .tabset-pills}
**Медианная амплитуда на клик**

#### Descriptive stat

```{r}
describeBy(distance_median ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "distance_median"
plot_list <- draw_plots_continuous_by_group(df, var = distance_median, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Медианная амплитуда на клик", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$distance_median);print(st)
check_normal_distribution(st)
ks <- ks.test(df$distance_median, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(distance_median)$statistic,
          p.value = shapiro.test(distance_median)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = distance_median)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - distance_median", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$distance_median)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$distance_median, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$distance_median, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "distance_median")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('distance_median', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=distance_median, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### distance_trimmed {.tabset .tabset-fade .tabset-pills}
**Усеченное среднее амплитуды на клик**

#### Descriptive stat

```{r}
describeBy(distance_trimmed ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "distance_trimmed"
plot_list <- draw_plots_continuous_by_group(df, var = distance_trimmed, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Усеченное среднее амплитуды на клик", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$distance_trimmed);print(st)
check_normal_distribution(st)
ks <- ks.test(df$distance_trimmed, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(distance_trimmed)$statistic,
          p.value = shapiro.test(distance_trimmed)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = distance_trimmed)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - distance_trimmed", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$distance_trimmed)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$distance_trimmed, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$distance_trimmed, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "distance_trimmed")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('distance_trimmed', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=distance_trimmed, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### distance_mad {.tabset .tabset-fade .tabset-pills}
**Среднее Абсолютное Отклонение амплитуды на клик**

#### Descriptive stat

```{r}
describeBy(distance_mad ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "distance_mad"
plot_list <- draw_plots_continuous_by_group(df, var = distance_mad, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Среднее Абсолютное Отклонение амплитуды на клик", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$distance_mad);print(st)
check_normal_distribution(st)
ks <- ks.test(df$distance_mad, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(distance_mad)$statistic,
          p.value = shapiro.test(distance_mad)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = distance_mad)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - distance_mad", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$distance_mad)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$distance_mad, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$distance_mad, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "distance_mad")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('distance_mad', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=distance_mad, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### distance_min {.tabset .tabset-fade .tabset-pills}
**Минимальная амплитуда клика**

#### Descriptive stat

```{r}
describeBy(distance_min ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "distance_min"
plot_list <- draw_plots_continuous_by_group(df, var = distance_min, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Минимальная амплитуда клика", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$distance_min);print(st)
check_normal_distribution(st)
ks <- ks.test(df$distance_min, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(distance_min)$statistic,
          p.value = shapiro.test(distance_min)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = distance_min)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - distance_min", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$distance_min)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$distance_min, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$distance_min, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "distance_min")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('distance_min', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=distance_min, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### distance_max {.tabset .tabset-fade .tabset-pills}
**Максимальная амплитуда клика**

#### Descriptive stat

```{r}
describeBy(distance_max ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "distance_max"
plot_list <- draw_plots_continuous_by_group(df, var = distance_max, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Максимальная амплитуда клика", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$distance_max);print(st)
check_normal_distribution(st)
ks <- ks.test(df$distance_max, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(distance_max)$statistic,
          p.value = shapiro.test(distance_max)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = distance_max)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - distance_max", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$distance_max)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$distance_max, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$distance_max, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "distance_max")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('distance_max', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=distance_max, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### distance_range {.tabset .tabset-fade .tabset-pills}
**Размах амплитуды на клик**

#### Descriptive stat

```{r}
describeBy(distance_range ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "distance_range"
plot_list <- draw_plots_continuous_by_group(df, var = distance_range, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Размах амплитуды на клик", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$distance_range);print(st)
check_normal_distribution(st)
ks <- ks.test(df$distance_range, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(distance_range)$statistic,
          p.value = shapiro.test(distance_range)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = distance_range)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - distance_range", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$distance_range)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$distance_range, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$distance_range, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "distance_range")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('distance_range', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=distance_range, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### distance_skew {.tabset .tabset-fade .tabset-pills}
**Коэффициент асимметрии амплитуды**

#### Descriptive stat

```{r}
describeBy(distance_skew ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "distance_skew"
plot_list <- draw_plots_continuous_by_group(df, var = distance_skew, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Коэффициент асимметрии амплитуды", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$distance_skew);print(st)
check_normal_distribution(st)
ks <- ks.test(df$distance_skew, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(distance_skew)$statistic,
          p.value = shapiro.test(distance_skew)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = distance_skew)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - distance_skew", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$distance_skew)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$distance_skew, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$distance_skew, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "distance_skew")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('distance_skew', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=distance_skew, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### distance_kurtosis {.tabset .tabset-fade .tabset-pills}
**Эксцесс амплитуды**

#### Descriptive stat

```{r}
describeBy(distance_kurtosis ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "distance_kurtosis"
plot_list <- draw_plots_continuous_by_group(df, var = distance_kurtosis, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Эксцесс амплитуды", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$distance_kurtosis);print(st)
check_normal_distribution(st)
ks <- ks.test(df$distance_kurtosis, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(distance_kurtosis)$statistic,
          p.value = shapiro.test(distance_kurtosis)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = distance_kurtosis)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - distance_kurtosis", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$distance_kurtosis)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$distance_kurtosis, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$distance_kurtosis, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "distance_kurtosis")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('distance_kurtosis', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=distance_kurtosis, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### distance_se {.tabset .tabset-fade .tabset-pills}
**Стандартная ошибка среднего амплитуды**

#### Descriptive stat

```{r}
describeBy(distance_se ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "distance_se"
plot_list <- draw_plots_continuous_by_group(df, var = distance_se, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Стандартная ошибка среднего амплитуды", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$distance_se);print(st)
check_normal_distribution(st)
ks <- ks.test(df$distance_se, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(distance_se)$statistic,
          p.value = shapiro.test(distance_se)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = distance_se)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - distance_se", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$distance_se)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$distance_se, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$distance_se, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "distance_se")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('distance_se', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=distance_se, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### distance_q0.25 {.tabset .tabset-fade .tabset-pills}
**Нижний квартиль амплитуды**

#### Descriptive stat

```{r}
describeBy(distance_q0.25 ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "distance_q0.25"
plot_list <- draw_plots_continuous_by_group(df, var = distance_q0.25, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Нижний квартиль амплитуды", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$distance_q0.25);print(st)
check_normal_distribution(st)
ks <- ks.test(df$distance_q0.25, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(distance_q0.25)$statistic,
          p.value = shapiro.test(distance_q0.25)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = distance_q0.25)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - distance_q0.25", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$distance_q0.25)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$distance_q0.25, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$distance_q0.25, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "distance_q0.25")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('distance_q0.25', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=distance_q0.25, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### distance_q0.75 {.tabset .tabset-fade .tabset-pills}
**Верхний квартиль амплитуды**

#### Descriptive stat

```{r}
describeBy(distance_q0.75 ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "distance_q0.75"
plot_list <- draw_plots_continuous_by_group(df, var = distance_q0.75, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Верхний квартиль амплитуды", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$distance_q0.75);print(st)
check_normal_distribution(st)
ks <- ks.test(df$distance_q0.75, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(distance_q0.75)$statistic,
          p.value = shapiro.test(distance_q0.75)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = distance_q0.75)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - distance_q0.75", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$distance_q0.75)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$distance_q0.75, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$distance_q0.75, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "distance_q0.75")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('distance_q0.75', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=distance_q0.75, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### distance_trend {.tabset .tabset-fade .tabset-pills}
**Линейный тренд амплитуды**

#### Descriptive stat

```{r}
describeBy(distance_trend ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "distance_trend"
plot_list <- draw_plots_continuous_by_group(df, var = distance_trend, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Линейный тренд амплитуды", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$distance_trend);print(st)
check_normal_distribution(st)
ks <- ks.test(df$distance_trend, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(distance_trend)$statistic,
          p.value = shapiro.test(distance_trend)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = distance_trend)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - distance_trend", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$distance_trend)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$distance_trend, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$distance_trend, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "distance_trend")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('distance_trend', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=distance_trend, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### pause_total {.tabset .tabset-fade .tabset-pills}
**Общее время пауз**

#### Descriptive stat

```{r}
describeBy(pause_total ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "pause_total"
plot_list <- draw_plots_continuous_by_group(df, var = pause_total, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Общее время пауз", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$pause_total);print(st)
check_normal_distribution(st)
ks <- ks.test(df$pause_total, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(pause_total)$statistic,
          p.value = shapiro.test(pause_total)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = pause_total)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - pause_total", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$pause_total)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$pause_total, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$pause_total, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "pause_total")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('pause_total', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=pause_total, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### pause_number {.tabset .tabset-fade .tabset-pills}
**Количество пауз**

#### Descriptive stat

```{r}
describeBy(pause_number ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "pause_number"
plot_list <- draw_plots_continuous_by_group(df, var = pause_number, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Количество пауз", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$pause_number);print(st)
check_normal_distribution(st)
ks <- ks.test(df$pause_number, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(pause_number)$statistic,
          p.value = shapiro.test(pause_number)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = pause_number)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - pause_number", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$pause_number)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$pause_number, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$pause_number, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "pause_number")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('pause_number', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=pause_number, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### pause_mean {.tabset .tabset-fade .tabset-pills}
**Среднее пауза**

#### Descriptive stat

```{r}
describeBy(pause_mean ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "pause_mean"
plot_list <- draw_plots_continuous_by_group(df, var = pause_mean, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Среднее пауза", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$pause_mean);print(st)
check_normal_distribution(st)
ks <- ks.test(df$pause_mean, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(pause_mean)$statistic,
          p.value = shapiro.test(pause_mean)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = pause_mean)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - pause_mean", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$pause_mean)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$pause_mean, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$pause_mean, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "pause_mean")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('pause_mean', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=pause_mean, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### pause_sd {.tabset .tabset-fade .tabset-pills}
**Стандартное отклонение пауз**

#### Descriptive stat

```{r}
describeBy(pause_sd ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "pause_sd"
plot_list <- draw_plots_continuous_by_group(df, var = pause_sd, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Стандартное отклонение пауз", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$pause_sd);print(st)
check_normal_distribution(st)
ks <- ks.test(df$pause_sd, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(pause_sd)$statistic,
          p.value = shapiro.test(pause_sd)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = pause_sd)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - pause_sd", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$pause_sd)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$pause_sd, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$pause_sd, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "pause_sd")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('pause_sd', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=pause_sd, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### pause_median {.tabset .tabset-fade .tabset-pills}
**Медианная пауза**

#### Descriptive stat

```{r}
describeBy(pause_median ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "pause_median"
plot_list <- draw_plots_continuous_by_group(df, var = pause_median, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Медианная пауза", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$pause_median);print(st)
check_normal_distribution(st)
ks <- ks.test(df$pause_median, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(pause_median)$statistic,
          p.value = shapiro.test(pause_median)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = pause_median)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - pause_median", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$pause_median)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$pause_median, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$pause_median, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "pause_median")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('pause_median', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=pause_median, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### pause_trimmed {.tabset .tabset-fade .tabset-pills}
**Усеченное среднее пауз**

#### Descriptive stat

```{r}
describeBy(pause_trimmed ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "pause_trimmed"
plot_list <- draw_plots_continuous_by_group(df, var = pause_trimmed, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Усеченное среднее пауз", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$pause_trimmed);print(st)
check_normal_distribution(st)
ks <- ks.test(df$pause_trimmed, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(pause_trimmed)$statistic,
          p.value = shapiro.test(pause_trimmed)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = pause_trimmed)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - pause_trimmed", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$pause_trimmed)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$pause_trimmed, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$pause_trimmed, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "pause_trimmed")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('pause_trimmed', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=pause_trimmed, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### pause_mad {.tabset .tabset-fade .tabset-pills}
**Среднее Абсолютное Отклонение пауз**

#### Descriptive stat

```{r}
describeBy(pause_mad ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "pause_mad"
plot_list <- draw_plots_continuous_by_group(df, var = pause_mad, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Среднее Абсолютное Отклонение пауз", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$pause_mad);print(st)
check_normal_distribution(st)
ks <- ks.test(df$pause_mad, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(pause_mad)$statistic,
          p.value = shapiro.test(pause_mad)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = pause_mad)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - pause_mad", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$pause_mad)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$pause_mad, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$pause_mad, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "pause_mad")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('pause_mad', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=pause_mad, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### pause_min {.tabset .tabset-fade .tabset-pills}
**Минимальное время паузы**

#### Descriptive stat

```{r}
describeBy(pause_min ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "pause_min"
plot_list <- draw_plots_continuous_by_group(df, var = pause_min, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Минимальное время паузы", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$pause_min);print(st)
check_normal_distribution(st)
ks <- ks.test(df$pause_min, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(pause_min)$statistic,
          p.value = shapiro.test(pause_min)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = pause_min)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - pause_min", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$pause_min)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$pause_min, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$pause_min, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "pause_min")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('pause_min', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=pause_min, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### pause_max {.tabset .tabset-fade .tabset-pills}
**Максимальное время паузы**

#### Descriptive stat

```{r}
describeBy(pause_max ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "pause_max"
plot_list <- draw_plots_continuous_by_group(df, var = pause_max, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Максимальное время паузы", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$pause_max);print(st)
check_normal_distribution(st)
ks <- ks.test(df$pause_max, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(pause_max)$statistic,
          p.value = shapiro.test(pause_max)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = pause_max)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - pause_max", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$pause_max)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$pause_max, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$pause_max, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "pause_max")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('pause_max', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=pause_max, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### pause_range {.tabset .tabset-fade .tabset-pills}
**Размах пауз**

#### Descriptive stat

```{r}
describeBy(pause_range ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "pause_range"
plot_list <- draw_plots_continuous_by_group(df, var = pause_range, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Размах пауз", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$pause_range);print(st)
check_normal_distribution(st)
ks <- ks.test(df$pause_range, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(pause_range)$statistic,
          p.value = shapiro.test(pause_range)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = pause_range)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - pause_range", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$pause_range)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$pause_range, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$pause_range, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "pause_range")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('pause_range', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=pause_range, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### pause_skew {.tabset .tabset-fade .tabset-pills}
**Коэффициент асимметрии пауз**

#### Descriptive stat

```{r}
describeBy(pause_skew ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "pause_skew"
plot_list <- draw_plots_continuous_by_group(df, var = pause_skew, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Коэффициент асимметрии пауз", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$pause_skew);print(st)
check_normal_distribution(st)
ks <- ks.test(df$pause_skew, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(pause_skew)$statistic,
          p.value = shapiro.test(pause_skew)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = pause_skew)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - pause_skew", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$pause_skew)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$pause_skew, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$pause_skew, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "pause_skew")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('pause_skew', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=pause_skew, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### pause_kurtosis {.tabset .tabset-fade .tabset-pills}
**Эксцесс пауз**

#### Descriptive stat

```{r}
describeBy(pause_kurtosis ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "pause_kurtosis"
plot_list <- draw_plots_continuous_by_group(df, var = pause_kurtosis, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Эксцесс пауз", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$pause_kurtosis);print(st)
check_normal_distribution(st)
ks <- ks.test(df$pause_kurtosis, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(pause_kurtosis)$statistic,
          p.value = shapiro.test(pause_kurtosis)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = pause_kurtosis)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - pause_kurtosis", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$pause_kurtosis)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$pause_kurtosis, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$pause_kurtosis, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "pause_kurtosis")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('pause_kurtosis', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=pause_kurtosis, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### pause_se {.tabset .tabset-fade .tabset-pills}
**Стандартная ошибка пауз**

#### Descriptive stat

```{r}
describeBy(pause_se ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "pause_se"
plot_list <- draw_plots_continuous_by_group(df, var = pause_se, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Стандартная ошибка пауз", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$pause_se);print(st)
check_normal_distribution(st)
ks <- ks.test(df$pause_se, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(pause_se)$statistic,
          p.value = shapiro.test(pause_se)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = pause_se)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - pause_se", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$pause_se)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$pause_se, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$pause_se, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "pause_se")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('pause_se', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=pause_se, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### pause_q0.25 {.tabset .tabset-fade .tabset-pills}
**Нижний квартиль пауз**

#### Descriptive stat

```{r}
describeBy(pause_q0.25 ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "pause_q0.25"
plot_list <- draw_plots_continuous_by_group(df, var = pause_q0.25, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Нижний квартиль пауз", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$pause_q0.25);print(st)
check_normal_distribution(st)
ks <- ks.test(df$pause_q0.25, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(pause_q0.25)$statistic,
          p.value = shapiro.test(pause_q0.25)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = pause_q0.25)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - pause_q0.25", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$pause_q0.25)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$pause_q0.25, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$pause_q0.25, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "pause_q0.25")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('pause_q0.25', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=pause_q0.25, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### pause_q0.75 {.tabset .tabset-fade .tabset-pills}
**Верхний квартиль пауз**

#### Descriptive stat

```{r}
describeBy(pause_q0.75 ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "pause_q0.75"
plot_list <- draw_plots_continuous_by_group(df, var = pause_q0.75, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Верхний квартиль пауз", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$pause_q0.75);print(st)
check_normal_distribution(st)
ks <- ks.test(df$pause_q0.75, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(pause_q0.75)$statistic,
          p.value = shapiro.test(pause_q0.75)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = pause_q0.75)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - pause_q0.75", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$pause_q0.75)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$pause_q0.75, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$pause_q0.75, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "pause_q0.75")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('pause_q0.75', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=pause_q0.75, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### pause_trend {.tabset .tabset-fade .tabset-pills}
**Линейный тренд пауз**

#### Descriptive stat

```{r}
describeBy(pause_trend ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "pause_trend"
plot_list <- draw_plots_continuous_by_group(df, var = pause_trend, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Линейный тренд пауз", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$pause_trend);print(st)
check_normal_distribution(st)
ks <- ks.test(df$pause_trend, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(pause_trend)$statistic,
          p.value = shapiro.test(pause_trend)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = pause_trend)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - pause_trend", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$pause_trend)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$pause_trend, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$pause_trend, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "pause_trend")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('pause_trend', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=pause_trend, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### stops {.tabset .tabset-fade .tabset-pills}
**Количество остановок**

#### Descriptive stat

```{r}
describeBy(stops ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "stops"
plot_list <- draw_plots_continuous_by_group(df, var = stops, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Количество остановок", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$stops);print(st)
check_normal_distribution(st)
ks <- ks.test(df$stops, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(stops)$statistic,
          p.value = shapiro.test(stops)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = stops)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - stops", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$stops)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$stops, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$stops, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "stops")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('stops', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=stops, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### velocity_mean {.tabset .tabset-fade .tabset-pills}
**Средняя гармоническая скорость**

#### Descriptive stat

```{r}
describeBy(velocity_mean ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "velocity_mean"
plot_list <- draw_plots_continuous_by_group(df, var = velocity_mean, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Средняя гармоническая скорость", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$velocity_mean);print(st)
check_normal_distribution(st)
ks <- ks.test(df$velocity_mean, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(velocity_mean)$statistic,
          p.value = shapiro.test(velocity_mean)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = velocity_mean)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - velocity_mean", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$velocity_mean)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$velocity_mean, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$velocity_mean, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "velocity_mean")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('velocity_mean', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=velocity_mean, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### velocity_sd {.tabset .tabset-fade .tabset-pills}
**Стандартное отклонение скорости**

#### Descriptive stat

```{r}
describeBy(velocity_sd ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "velocity_sd"
plot_list <- draw_plots_continuous_by_group(df, var = velocity_sd, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Стандартное отклонение скорости", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$velocity_sd);print(st)
check_normal_distribution(st)
ks <- ks.test(df$velocity_sd, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(velocity_sd)$statistic,
          p.value = shapiro.test(velocity_sd)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = velocity_sd)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - velocity_sd", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$velocity_sd)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$velocity_sd, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$velocity_sd, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "velocity_sd")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('velocity_sd', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=velocity_sd, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### velocity_mad {.tabset .tabset-fade .tabset-pills}
**Среднее абсолютное отклонение скорости**

#### Descriptive stat

```{r}
describeBy(velocity_mad ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "velocity_mad"
plot_list <- draw_plots_continuous_by_group(df, var = velocity_mad, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Среднее абсолютное отклонение скорости", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$velocity_mad);print(st)
check_normal_distribution(st)
ks <- ks.test(df$velocity_mad, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(velocity_mad)$statistic,
          p.value = shapiro.test(velocity_mad)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = velocity_mad)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - velocity_mad", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$velocity_mad)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$velocity_mad, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$velocity_mad, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "velocity_mad")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('velocity_mad', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=velocity_mad, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### velocity_min {.tabset .tabset-fade .tabset-pills}
**Минимальная скорость**

#### Descriptive stat

```{r}
describeBy(velocity_min ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "velocity_min"
plot_list <- draw_plots_continuous_by_group(df, var = velocity_min, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Минимальная скорость", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$velocity_min);print(st)
check_normal_distribution(st)
ks <- ks.test(df$velocity_min, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(velocity_min)$statistic,
          p.value = shapiro.test(velocity_min)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = velocity_min)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - velocity_min", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$velocity_min)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$velocity_min, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$velocity_min, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "velocity_min")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('velocity_min', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=velocity_min, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### velocity_max {.tabset .tabset-fade .tabset-pills}
**Максимальная скорость**

#### Descriptive stat

```{r}
describeBy(velocity_max ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "velocity_max"
plot_list <- draw_plots_continuous_by_group(df, var = velocity_max, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Максимальная скорость", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$velocity_max);print(st)
check_normal_distribution(st)
ks <- ks.test(df$velocity_max, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(velocity_max)$statistic,
          p.value = shapiro.test(velocity_max)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = velocity_max)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - velocity_max", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$velocity_max)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$velocity_max, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$velocity_max, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "velocity_max")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('velocity_max', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=velocity_max, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### velocity_range {.tabset .tabset-fade .tabset-pills}
**Размах скорости**

#### Descriptive stat

```{r}
describeBy(velocity_range ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "velocity_range"
plot_list <- draw_plots_continuous_by_group(df, var = velocity_range, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Размах скорости", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$velocity_range);print(st)
check_normal_distribution(st)
ks <- ks.test(df$velocity_range, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(velocity_range)$statistic,
          p.value = shapiro.test(velocity_range)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = velocity_range)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - velocity_range", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$velocity_range)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$velocity_range, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$velocity_range, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "velocity_range")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('velocity_range', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=velocity_range, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### velocity_skew {.tabset .tabset-fade .tabset-pills}
**Коэффициент асимметрии скорости**

#### Descriptive stat

```{r}
describeBy(velocity_skew ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "velocity_skew"
plot_list <- draw_plots_continuous_by_group(df, var = velocity_skew, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Коэффициент асимметрии скорости", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$velocity_skew);print(st)
check_normal_distribution(st)
ks <- ks.test(df$velocity_skew, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(velocity_skew)$statistic,
          p.value = shapiro.test(velocity_skew)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = velocity_skew)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - velocity_skew", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$velocity_skew)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$velocity_skew, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$velocity_skew, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "velocity_skew")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('velocity_skew', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=velocity_skew, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### velocity_kurtosis {.tabset .tabset-fade .tabset-pills}
**Эксцесс скорости**

#### Descriptive stat

```{r}
describeBy(velocity_kurtosis ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "velocity_kurtosis"
plot_list <- draw_plots_continuous_by_group(df, var = velocity_kurtosis, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Эксцесс скорости", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$velocity_kurtosis);print(st)
check_normal_distribution(st)
ks <- ks.test(df$velocity_kurtosis, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(velocity_kurtosis)$statistic,
          p.value = shapiro.test(velocity_kurtosis)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = velocity_kurtosis)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - velocity_kurtosis", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$velocity_kurtosis)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$velocity_kurtosis, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$velocity_kurtosis, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "velocity_kurtosis")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('velocity_kurtosis', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=velocity_kurtosis, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### velocity_se {.tabset .tabset-fade .tabset-pills}
**Стандартная ошибка скорости**

#### Descriptive stat

```{r}
describeBy(velocity_se ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "velocity_se"
plot_list <- draw_plots_continuous_by_group(df, var = velocity_se, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Стандартная ошибка скорости", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$velocity_se);print(st)
check_normal_distribution(st)
ks <- ks.test(df$velocity_se, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(velocity_se)$statistic,
          p.value = shapiro.test(velocity_se)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = velocity_se)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - velocity_se", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$velocity_se)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$velocity_se, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$velocity_se, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "velocity_se")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('velocity_se', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=velocity_se, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### velocity_q0.25 {.tabset .tabset-fade .tabset-pills}
**Нижний квартиль скорости**

#### Descriptive stat

```{r}
describeBy(velocity_q0.25 ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "velocity_q0.25"
plot_list <- draw_plots_continuous_by_group(df, var = velocity_q0.25, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Нижний квартиль скорости", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$velocity_q0.25);print(st)
check_normal_distribution(st)
ks <- ks.test(df$velocity_q0.25, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(velocity_q0.25)$statistic,
          p.value = shapiro.test(velocity_q0.25)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = velocity_q0.25)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - velocity_q0.25", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$velocity_q0.25)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$velocity_q0.25, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$velocity_q0.25, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "velocity_q0.25")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('velocity_q0.25', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=velocity_q0.25, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### velocity_q0.75 {.tabset .tabset-fade .tabset-pills}
**Верхний квартиль скорости**

#### Descriptive stat

```{r}
describeBy(velocity_q0.75 ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "velocity_q0.75"
plot_list <- draw_plots_continuous_by_group(df, var = velocity_q0.75, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Верхний квартиль скорости", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$velocity_q0.75);print(st)
check_normal_distribution(st)
ks <- ks.test(df$velocity_q0.75, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(velocity_q0.75)$statistic,
          p.value = shapiro.test(velocity_q0.75)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = velocity_q0.75)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - velocity_q0.75", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$velocity_q0.75)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$velocity_q0.75, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$velocity_q0.75, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "velocity_q0.75")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('velocity_q0.75', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=velocity_q0.75, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### velocity_trend {.tabset .tabset-fade .tabset-pills}
**Линейный тренд скорости**

#### Descriptive stat

```{r}
describeBy(velocity_trend ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "velocity_trend"
plot_list <- draw_plots_continuous_by_group(df, var = velocity_trend, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Линейный тренд скорости", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$velocity_trend);print(st)
check_normal_distribution(st)
ks <- ks.test(df$velocity_trend, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(velocity_trend)$statistic,
          p.value = shapiro.test(velocity_trend)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = velocity_trend)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - velocity_trend", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$velocity_trend)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$velocity_trend, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$velocity_trend, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "velocity_trend")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('velocity_trend', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=velocity_trend, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### acc_n {.tabset .tabset-fade .tabset-pills}
**Количество ускорений**

#### Descriptive stat

```{r}
describeBy(acc_n ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_n"
plot_list <- draw_plots_continuous_by_group(df, var = acc_n, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Количество ускорений", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$acc_n);print(st)
check_normal_distribution(st)
ks <- ks.test(df$acc_n, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(acc_n)$statistic,
          p.value = shapiro.test(acc_n)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = acc_n)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - acc_n", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$acc_n)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$acc_n, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$acc_n, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "acc_n")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_n', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=acc_n, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```











### acc_sd {.tabset .tabset-fade .tabset-pills}
**Стандартное отклонение ускорений**

#### Descriptive stat

```{r}
describeBy(acc_sd ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_sd"
plot_list <- draw_plots_continuous_by_group(df, var = acc_sd, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Стандартное отклонение ускорений", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$acc_sd);print(st)
check_normal_distribution(st)
ks <- ks.test(df$acc_sd, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(acc_sd)$statistic,
          p.value = shapiro.test(acc_sd)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = acc_sd)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - acc_sd", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$acc_sd)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$acc_sd, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$acc_sd, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "acc_sd")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_sd', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=acc_sd, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### acc_median {.tabset .tabset-fade .tabset-pills}
**Медианная ускорение**

#### Descriptive stat

```{r}
describeBy(acc_median ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_median"
plot_list <- draw_plots_continuous_by_group(df, var = acc_median, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Медианная ускорение", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$acc_median);print(st)
check_normal_distribution(st)
ks <- ks.test(df$acc_median, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(acc_median)$statistic,
          p.value = shapiro.test(acc_median)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = acc_median)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - acc_median", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$acc_median)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$acc_median, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$acc_median, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "acc_median")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_median', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=acc_median, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### acc_trimmed {.tabset .tabset-fade .tabset-pills}
**Усеченное среднее ускорения**

#### Descriptive stat

```{r}
describeBy(acc_trimmed ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_trimmed"
plot_list <- draw_plots_continuous_by_group(df, var = acc_trimmed, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Усеченное среднее ускорения", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$acc_trimmed);print(st)
check_normal_distribution(st)
ks <- ks.test(df$acc_trimmed, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(acc_trimmed)$statistic,
          p.value = shapiro.test(acc_trimmed)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = acc_trimmed)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - acc_trimmed", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$acc_trimmed)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$acc_trimmed, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$acc_trimmed, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "acc_trimmed")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_trimmed', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=acc_trimmed, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### acc_mad {.tabset .tabset-fade .tabset-pills}
**Среднее абсолютное отклонение ускорений**

#### Descriptive stat

```{r}
describeBy(acc_mad ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_mad"
plot_list <- draw_plots_continuous_by_group(df, var = acc_mad, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Среднее абсолютное отклонение ускорений", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$acc_mad);print(st)
check_normal_distribution(st)
ks <- ks.test(df$acc_mad, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(acc_mad)$statistic,
          p.value = shapiro.test(acc_mad)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = acc_mad)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - acc_mad", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$acc_mad)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$acc_mad, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$acc_mad, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "acc_mad")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_mad', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=acc_mad, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### acc_min {.tabset .tabset-fade .tabset-pills}
**Минимальное ускорение**

#### Descriptive stat

```{r}
describeBy(acc_min ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_min"
plot_list <- draw_plots_continuous_by_group(df, var = acc_min, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Минимальное ускорение", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$acc_min);print(st)
check_normal_distribution(st)
ks <- ks.test(df$acc_min, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(acc_min)$statistic,
          p.value = shapiro.test(acc_min)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = acc_min)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - acc_min", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$acc_min)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$acc_min, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$acc_min, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "acc_min")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_min', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=acc_min, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### acc_max {.tabset .tabset-fade .tabset-pills}
**Максимальное ускорение**

#### Descriptive stat

```{r}
describeBy(acc_max ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_max"
plot_list <- draw_plots_continuous_by_group(df, var = acc_max, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Максимальное ускорение", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$acc_max);print(st)
check_normal_distribution(st)
ks <- ks.test(df$acc_max, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(acc_max)$statistic,
          p.value = shapiro.test(acc_max)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = acc_max)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - acc_max", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$acc_max)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$acc_max, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$acc_max, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "acc_max")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_max', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=acc_max, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### acc_range {.tabset .tabset-fade .tabset-pills}
**Размах ускорений**

#### Descriptive stat

```{r}
describeBy(acc_range ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_range"
plot_list <- draw_plots_continuous_by_group(df, var = acc_range, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Размах ускорений", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$acc_range);print(st)
check_normal_distribution(st)
ks <- ks.test(df$acc_range, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(acc_range)$statistic,
          p.value = shapiro.test(acc_range)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = acc_range)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - acc_range", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$acc_range)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$acc_range, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$acc_range, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "acc_range")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_range', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=acc_range, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### acc_skew {.tabset .tabset-fade .tabset-pills}
**Коэффициент асимметрии ускорений**

#### Descriptive stat

```{r}
describeBy(acc_skew ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_skew"
plot_list <- draw_plots_continuous_by_group(df, var = acc_skew, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Коэффициент асимметрии ускорений", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$acc_skew);print(st)
check_normal_distribution(st)
ks <- ks.test(df$acc_skew, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(acc_skew)$statistic,
          p.value = shapiro.test(acc_skew)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = acc_skew)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - acc_skew", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$acc_skew)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$acc_skew, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$acc_skew, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "acc_skew")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_skew', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=acc_skew, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### acc_kurtosis {.tabset .tabset-fade .tabset-pills}
**Эксцесс ускорений**

#### Descriptive stat

```{r}
describeBy(acc_kurtosis ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_kurtosis"
plot_list <- draw_plots_continuous_by_group(df, var = acc_kurtosis, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Эксцесс ускорений", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$acc_kurtosis);print(st)
check_normal_distribution(st)
ks <- ks.test(df$acc_kurtosis, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(acc_kurtosis)$statistic,
          p.value = shapiro.test(acc_kurtosis)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = acc_kurtosis)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - acc_kurtosis", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$acc_kurtosis)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$acc_kurtosis, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$acc_kurtosis, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "acc_kurtosis")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_kurtosis', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=acc_kurtosis, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### acc_se {.tabset .tabset-fade .tabset-pills}
**Стандартная ошибка ускорений**

#### Descriptive stat

```{r}
describeBy(acc_se ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_se"
plot_list <- draw_plots_continuous_by_group(df, var = acc_se, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Стандартная ошибка ускорений", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$acc_se);print(st)
check_normal_distribution(st)
ks <- ks.test(df$acc_se, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(acc_se)$statistic,
          p.value = shapiro.test(acc_se)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = acc_se)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - acc_se", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$acc_se)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$acc_se, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$acc_se, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "acc_se")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_se', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=acc_se, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### acc_q0.25 {.tabset .tabset-fade .tabset-pills}
**Нижний квартиль ускорений**

#### Descriptive stat

```{r}
describeBy(acc_q0.25 ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_q0.25"
plot_list <- draw_plots_continuous_by_group(df, var = acc_q0.25, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Нижний квартиль ускорений", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$acc_q0.25);print(st)
check_normal_distribution(st)
ks <- ks.test(df$acc_q0.25, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(acc_q0.25)$statistic,
          p.value = shapiro.test(acc_q0.25)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = acc_q0.25)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - acc_q0.25", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$acc_q0.25)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$acc_q0.25, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$acc_q0.25, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "acc_q0.25")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_q0.25', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=acc_q0.25, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### acc_q0.75 {.tabset .tabset-fade .tabset-pills}
**Верхний квартиль ускорений**

#### Descriptive stat

```{r}
describeBy(acc_q0.75 ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_q0.75"
plot_list <- draw_plots_continuous_by_group(df, var = acc_q0.75, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Верхний квартиль ускорений", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$acc_q0.75);print(st)
check_normal_distribution(st)
ks <- ks.test(df$acc_q0.75, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(acc_q0.75)$statistic,
          p.value = shapiro.test(acc_q0.75)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = acc_q0.75)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - acc_q0.75", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$acc_q0.75)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$acc_q0.75, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$acc_q0.75, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "acc_q0.75")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_q0.75', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=acc_q0.75, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### jerk_line {.tabset .tabset-fade .tabset-pills}
**Линия рывков**

#### Descriptive stat

```{r}
describeBy(jerk_line ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "jerk_line"
plot_list <- draw_plots_continuous_by_group(df, var = jerk_line, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Линия рывков", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$jerk_line);print(st)
check_normal_distribution(st)
ks <- ks.test(df$jerk_line, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(jerk_line)$statistic,
          p.value = shapiro.test(jerk_line)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = jerk_line)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - jerk_line", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$jerk_line)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$jerk_line, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$jerk_line, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "jerk_line")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('jerk_line', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=jerk_line, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### n_jerk {.tabset .tabset-fade .tabset-pills}
**Количество рывков**

#### Descriptive stat

```{r}
describeBy(n_jerk ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "n_jerk"
plot_list <- draw_plots_continuous_by_group(df, var = n_jerk, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Количество рывков", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$n_jerk);print(st)
check_normal_distribution(st)
ks <- ks.test(df$n_jerk, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(n_jerk)$statistic,
          p.value = shapiro.test(n_jerk)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = n_jerk)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - n_jerk", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$n_jerk)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$n_jerk, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$n_jerk, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "n_jerk")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('n_jerk', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=n_jerk, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### dec_n {.tabset .tabset-fade .tabset-pills}
**Количество замедлений**

#### Descriptive stat

```{r}
describeBy(dec_n ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "dec_n"
plot_list <- draw_plots_continuous_by_group(df, var = dec_n, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Количество замедлений", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$dec_n);print(st)
check_normal_distribution(st)
ks <- ks.test(df$dec_n, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(dec_n)$statistic,
          p.value = shapiro.test(dec_n)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = dec_n)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - dec_n", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$dec_n)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$dec_n, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$dec_n, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "dec_n")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('dec_n', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=dec_n, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### dec_mean {.tabset .tabset-fade .tabset-pills}
**Среднее замедление**

#### Descriptive stat

```{r}
describeBy(dec_mean ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "dec_mean"
plot_list <- draw_plots_continuous_by_group(df, var = dec_mean, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Среднее замедление", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$dec_mean);print(st)
check_normal_distribution(st)
ks <- ks.test(df$dec_mean, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(dec_mean)$statistic,
          p.value = shapiro.test(dec_mean)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = dec_mean)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - dec_mean", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$dec_mean)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$dec_mean, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$dec_mean, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "dec_mean")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('dec_mean', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=dec_mean, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### dec_sd {.tabset .tabset-fade .tabset-pills}
**Стандартное отклонение замедлений**

#### Descriptive stat

```{r}
describeBy(dec_sd ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "dec_sd"
plot_list <- draw_plots_continuous_by_group(df, var = dec_sd, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Стандартное отклонение замедлений", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$dec_sd);print(st)
check_normal_distribution(st)
ks <- ks.test(df$dec_sd, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(dec_sd)$statistic,
          p.value = shapiro.test(dec_sd)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = dec_sd)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - dec_sd", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$dec_sd)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$dec_sd, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$dec_sd, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "dec_sd")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('dec_sd', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=dec_sd, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### dec_median {.tabset .tabset-fade .tabset-pills}
**Медианная замедлений**

#### Descriptive stat

```{r}
describeBy(dec_median ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "dec_median"
plot_list <- draw_plots_continuous_by_group(df, var = dec_median, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Медианная замедлений", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$dec_median);print(st)
check_normal_distribution(st)
ks <- ks.test(df$dec_median, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(dec_median)$statistic,
          p.value = shapiro.test(dec_median)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = dec_median)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - dec_median", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$dec_median)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$dec_median, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$dec_median, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "dec_median")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('dec_median', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=dec_median, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### dec_trimmed {.tabset .tabset-fade .tabset-pills}
**Усеченное среднее замедлений**

#### Descriptive stat

```{r}
describeBy(dec_trimmed ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "dec_trimmed"
plot_list <- draw_plots_continuous_by_group(df, var = dec_trimmed, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Усеченное среднее замедлений", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$dec_trimmed);print(st)
check_normal_distribution(st)
ks <- ks.test(df$dec_trimmed, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(dec_trimmed)$statistic,
          p.value = shapiro.test(dec_trimmed)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = dec_trimmed)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - dec_trimmed", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$dec_trimmed)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$dec_trimmed, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$dec_trimmed, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "dec_trimmed")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('dec_trimmed', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=dec_trimmed, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### dec_mad {.tabset .tabset-fade .tabset-pills}
**Среднее абсолютное отклонение замедлений**

#### Descriptive stat

```{r}
describeBy(dec_mad ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "dec_mad"
plot_list <- draw_plots_continuous_by_group(df, var = dec_mad, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Среднее абсолютное отклонение замедлений", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$dec_mad);print(st)
check_normal_distribution(st)
ks <- ks.test(df$dec_mad, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(dec_mad)$statistic,
          p.value = shapiro.test(dec_mad)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = dec_mad)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - dec_mad", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$dec_mad)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$dec_mad, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$dec_mad, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "dec_mad")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('dec_mad', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=dec_mad, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### dec_min {.tabset .tabset-fade .tabset-pills}
**Минимальное замедление**

#### Descriptive stat

```{r}
describeBy(dec_min ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "dec_min"
plot_list <- draw_plots_continuous_by_group(df, var = dec_min, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Минимальное замедление", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$dec_min);print(st)
check_normal_distribution(st)
ks <- ks.test(df$dec_min, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(dec_min)$statistic,
          p.value = shapiro.test(dec_min)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = dec_min)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - dec_min", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$dec_min)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$dec_min, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$dec_min, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "dec_min")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('dec_min', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=dec_min, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### dec_max {.tabset .tabset-fade .tabset-pills}
**Максимальное замедление**

#### Descriptive stat

```{r}
describeBy(dec_max ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "dec_max"
plot_list <- draw_plots_continuous_by_group(df, var = dec_max, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Максимальное замедление", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$dec_max);print(st)
check_normal_distribution(st)
ks <- ks.test(df$dec_max, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(dec_max)$statistic,
          p.value = shapiro.test(dec_max)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = dec_max)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - dec_max", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$dec_max)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$dec_max, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$dec_max, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "dec_max")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('dec_max', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=dec_max, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### dec_range {.tabset .tabset-fade .tabset-pills}
**Размах замедлений**

#### Descriptive stat

```{r}
describeBy(dec_range ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "dec_range"
plot_list <- draw_plots_continuous_by_group(df, var = dec_range, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Размах замедлений", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$dec_range);print(st)
check_normal_distribution(st)
ks <- ks.test(df$dec_range, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(dec_range)$statistic,
          p.value = shapiro.test(dec_range)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = dec_range)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - dec_range", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$dec_range)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$dec_range, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$dec_range, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "dec_range")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('dec_range', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=dec_range, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### dec_skew {.tabset .tabset-fade .tabset-pills}
**Коэффициент асимметрии замедлений**

#### Descriptive stat

```{r}
describeBy(dec_skew ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "dec_skew"
plot_list <- draw_plots_continuous_by_group(df, var = dec_skew, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Коэффициент асимметрии замедлений", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$dec_skew);print(st)
check_normal_distribution(st)
ks <- ks.test(df$dec_skew, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(dec_skew)$statistic,
          p.value = shapiro.test(dec_skew)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = dec_skew)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - dec_skew", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$dec_skew)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$dec_skew, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$dec_skew, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "dec_skew")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('dec_skew', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=dec_skew, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### dec_kurtosis {.tabset .tabset-fade .tabset-pills}
**Эксцесс замедлений**

#### Descriptive stat

```{r}
describeBy(dec_kurtosis ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "dec_kurtosis"
plot_list <- draw_plots_continuous_by_group(df, var = dec_kurtosis, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Эксцесс замедлений", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$dec_kurtosis);print(st)
check_normal_distribution(st)
ks <- ks.test(df$dec_kurtosis, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(dec_kurtosis)$statistic,
          p.value = shapiro.test(dec_kurtosis)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = dec_kurtosis)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - dec_kurtosis", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$dec_kurtosis)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$dec_kurtosis, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$dec_kurtosis, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "dec_kurtosis")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('dec_kurtosis', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=dec_kurtosis, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### dec_se {.tabset .tabset-fade .tabset-pills}
**Стандартная ошибка замедлений**

#### Descriptive stat

```{r}
describeBy(dec_se ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "dec_se"
plot_list <- draw_plots_continuous_by_group(df, var = dec_se, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Стандартная ошибка замедлений", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$dec_se);print(st)
check_normal_distribution(st)
ks <- ks.test(df$dec_se, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(dec_se)$statistic,
          p.value = shapiro.test(dec_se)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = dec_se)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - dec_se", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$dec_se)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$dec_se, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$dec_se, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "dec_se")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('dec_se', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=dec_se, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### dec_q0.25 {.tabset .tabset-fade .tabset-pills}
**Нижний квартиль замедлений**

#### Descriptive stat

```{r}
describeBy(dec_q0.25 ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "dec_q0.25"
plot_list <- draw_plots_continuous_by_group(df, var = dec_q0.25, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Нижний квартиль замедлений", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$dec_q0.25);print(st)
check_normal_distribution(st)
ks <- ks.test(df$dec_q0.25, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(dec_q0.25)$statistic,
          p.value = shapiro.test(dec_q0.25)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = dec_q0.25)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - dec_q0.25", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$dec_q0.25)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$dec_q0.25, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$dec_q0.25, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "dec_q0.25")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('dec_q0.25', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=dec_q0.25, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### dec_q0.75 {.tabset .tabset-fade .tabset-pills}
**Верхний квартиль замедлений**

#### Descriptive stat

```{r}
describeBy(dec_q0.75 ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "dec_q0.75"
plot_list <- draw_plots_continuous_by_group(df, var = dec_q0.75, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Верхний квартиль замедлений", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$dec_q0.75);print(st)
check_normal_distribution(st)
ks <- ks.test(df$dec_q0.75, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(dec_q0.75)$statistic,
          p.value = shapiro.test(dec_q0.75)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = dec_q0.75)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - dec_q0.75", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$dec_q0.75)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$dec_q0.75, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$dec_q0.75, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "dec_q0.75")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('dec_q0.75', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=dec_q0.75, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### braking_line {.tabset .tabset-fade .tabset-pills}
**Линия резких торможений**

#### Descriptive stat

```{r}
describeBy(braking_line ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "braking_line"
plot_list <- draw_plots_continuous_by_group(df, var = braking_line, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Линия резких торможений", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$braking_line);print(st)
check_normal_distribution(st)
ks <- ks.test(df$braking_line, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(braking_line)$statistic,
          p.value = shapiro.test(braking_line)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = braking_line)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - braking_line", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$braking_line)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$braking_line, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$braking_line, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "braking_line")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('braking_line', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=braking_line, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### n_braking {.tabset .tabset-fade .tabset-pills}
**Количество резких торможений**

#### Descriptive stat

```{r}
describeBy(n_braking ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "n_braking"
plot_list <- draw_plots_continuous_by_group(df, var = n_braking, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Количество резких торможений", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$n_braking);print(st)
check_normal_distribution(st)
ks <- ks.test(df$n_braking, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(n_braking)$statistic,
          p.value = shapiro.test(n_braking)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = n_braking)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - n_braking", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$n_braking)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$n_braking, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$n_braking, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "n_braking")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('n_braking', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=n_braking, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### acc_per_sec_mean {.tabset .tabset-fade .tabset-pills}
**Среднее количество ускорений за секунду**

#### Descriptive stat

```{r}
describeBy(acc_per_sec_mean ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_per_sec_mean"
plot_list <- draw_plots_continuous_by_group(df, var = acc_per_sec_mean, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Среднее количество ускорений за секунду", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$acc_per_sec_mean);print(st)
check_normal_distribution(st)
ks <- ks.test(df$acc_per_sec_mean, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(acc_per_sec_mean)$statistic,
          p.value = shapiro.test(acc_per_sec_mean)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = acc_per_sec_mean)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - acc_per_sec_mean", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$acc_per_sec_mean)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$acc_per_sec_mean, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$acc_per_sec_mean, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "acc_per_sec_mean")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_per_sec_mean', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=acc_per_sec_mean, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### acc_per_sec_sd {.tabset .tabset-fade .tabset-pills}
**Стандартное отклонение количества ускорений за секунду **

#### Descriptive stat

```{r}
describeBy(acc_per_sec_sd ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_per_sec_sd"
plot_list <- draw_plots_continuous_by_group(df, var = acc_per_sec_sd, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Стандартное отклонение количества ускорений за секунду ", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$acc_per_sec_sd);print(st)
check_normal_distribution(st)
ks <- ks.test(df$acc_per_sec_sd, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(acc_per_sec_sd)$statistic,
          p.value = shapiro.test(acc_per_sec_sd)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = acc_per_sec_sd)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - acc_per_sec_sd", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$acc_per_sec_sd)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$acc_per_sec_sd, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$acc_per_sec_sd, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "acc_per_sec_sd")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_per_sec_sd', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=acc_per_sec_sd, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### acc_per_sec_median {.tabset .tabset-fade .tabset-pills}
**Медианное количество ускорений за секунду**

#### Descriptive stat

```{r}
describeBy(acc_per_sec_median ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_per_sec_median"
plot_list <- draw_plots_continuous_by_group(df, var = acc_per_sec_median, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Медианное количество ускорений за секунду", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$acc_per_sec_median);print(st)
check_normal_distribution(st)
ks <- ks.test(df$acc_per_sec_median, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(acc_per_sec_median)$statistic,
          p.value = shapiro.test(acc_per_sec_median)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = acc_per_sec_median)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - acc_per_sec_median", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$acc_per_sec_median)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$acc_per_sec_median, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$acc_per_sec_median, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "acc_per_sec_median")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_per_sec_median', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=acc_per_sec_median, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### acc_per_sec_trimmed {.tabset .tabset-fade .tabset-pills}
**Усеченное среднее количества ускорений за секунду**

#### Descriptive stat

```{r}
describeBy(acc_per_sec_trimmed ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_per_sec_trimmed"
plot_list <- draw_plots_continuous_by_group(df, var = acc_per_sec_trimmed, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Усеченное среднее количества ускорений за секунду", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$acc_per_sec_trimmed);print(st)
check_normal_distribution(st)
ks <- ks.test(df$acc_per_sec_trimmed, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(acc_per_sec_trimmed)$statistic,
          p.value = shapiro.test(acc_per_sec_trimmed)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = acc_per_sec_trimmed)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - acc_per_sec_trimmed", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$acc_per_sec_trimmed)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$acc_per_sec_trimmed, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$acc_per_sec_trimmed, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "acc_per_sec_trimmed")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_per_sec_trimmed', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=acc_per_sec_trimmed, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### acc_per_sec_mad {.tabset .tabset-fade .tabset-pills}
**Среднее абсолютное отклонение количества ускорений за секунду**

#### Descriptive stat

```{r}
describeBy(acc_per_sec_mad ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_per_sec_mad"
plot_list <- draw_plots_continuous_by_group(df, var = acc_per_sec_mad, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Среднее абсолютное отклонение количества ускорений за секунду", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$acc_per_sec_mad);print(st)
check_normal_distribution(st)
ks <- ks.test(df$acc_per_sec_mad, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(acc_per_sec_mad)$statistic,
          p.value = shapiro.test(acc_per_sec_mad)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = acc_per_sec_mad)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - acc_per_sec_mad", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$acc_per_sec_mad)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$acc_per_sec_mad, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$acc_per_sec_mad, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "acc_per_sec_mad")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_per_sec_mad', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=acc_per_sec_mad, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### acc_per_sec_min {.tabset .tabset-fade .tabset-pills}
**Минимальное количество ускорений за секунду**

#### Descriptive stat

```{r}
describeBy(acc_per_sec_min ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_per_sec_min"
plot_list <- draw_plots_continuous_by_group(df, var = acc_per_sec_min, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Минимальное количество ускорений за секунду", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$acc_per_sec_min);print(st)
check_normal_distribution(st)
ks <- ks.test(df$acc_per_sec_min, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(acc_per_sec_min)$statistic,
          p.value = shapiro.test(acc_per_sec_min)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = acc_per_sec_min)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - acc_per_sec_min", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$acc_per_sec_min)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$acc_per_sec_min, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$acc_per_sec_min, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "acc_per_sec_min")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_per_sec_min', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=acc_per_sec_min, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### acc_per_sec_max {.tabset .tabset-fade .tabset-pills}
**Максимальное количество ускорений за секунду**

#### Descriptive stat

```{r}
describeBy(acc_per_sec_max ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_per_sec_max"
plot_list <- draw_plots_continuous_by_group(df, var = acc_per_sec_max, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Максимальное количество ускорений за секунду", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$acc_per_sec_max);print(st)
check_normal_distribution(st)
ks <- ks.test(df$acc_per_sec_max, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(acc_per_sec_max)$statistic,
          p.value = shapiro.test(acc_per_sec_max)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = acc_per_sec_max)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - acc_per_sec_max", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$acc_per_sec_max)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$acc_per_sec_max, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$acc_per_sec_max, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "acc_per_sec_max")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_per_sec_max', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=acc_per_sec_max, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### acc_per_sec_range {.tabset .tabset-fade .tabset-pills}
**Размах количества ускорений за секунду**

#### Descriptive stat

```{r}
describeBy(acc_per_sec_range ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_per_sec_range"
plot_list <- draw_plots_continuous_by_group(df, var = acc_per_sec_range, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Размах количества ускорений за секунду", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$acc_per_sec_range);print(st)
check_normal_distribution(st)
ks <- ks.test(df$acc_per_sec_range, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(acc_per_sec_range)$statistic,
          p.value = shapiro.test(acc_per_sec_range)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = acc_per_sec_range)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - acc_per_sec_range", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$acc_per_sec_range)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$acc_per_sec_range, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$acc_per_sec_range, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "acc_per_sec_range")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_per_sec_range', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=acc_per_sec_range, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### acc_per_sec_skew {.tabset .tabset-fade .tabset-pills}
**Коэффициент асимметрии количества ускорений за секунду**

#### Descriptive stat

```{r}
describeBy(acc_per_sec_skew ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_per_sec_skew"
plot_list <- draw_plots_continuous_by_group(df, var = acc_per_sec_skew, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Коэффициент асимметрии количества ускорений за секунду", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$acc_per_sec_skew);print(st)
check_normal_distribution(st)
ks <- ks.test(df$acc_per_sec_skew, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(acc_per_sec_skew)$statistic,
          p.value = shapiro.test(acc_per_sec_skew)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = acc_per_sec_skew)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - acc_per_sec_skew", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$acc_per_sec_skew)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$acc_per_sec_skew, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$acc_per_sec_skew, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "acc_per_sec_skew")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_per_sec_skew', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=acc_per_sec_skew, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### acc_per_sec_kurtosis {.tabset .tabset-fade .tabset-pills}
**Эксцесс количества ускорений за секунду**

#### Descriptive stat

```{r}
describeBy(acc_per_sec_kurtosis ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_per_sec_kurtosis"
plot_list <- draw_plots_continuous_by_group(df, var = acc_per_sec_kurtosis, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Эксцесс количества ускорений за секунду", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$acc_per_sec_kurtosis);print(st)
check_normal_distribution(st)
ks <- ks.test(df$acc_per_sec_kurtosis, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(acc_per_sec_kurtosis)$statistic,
          p.value = shapiro.test(acc_per_sec_kurtosis)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = acc_per_sec_kurtosis)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - acc_per_sec_kurtosis", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$acc_per_sec_kurtosis)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$acc_per_sec_kurtosis, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$acc_per_sec_kurtosis, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "acc_per_sec_kurtosis")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_per_sec_kurtosis', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=acc_per_sec_kurtosis, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### acc_per_sec_se {.tabset .tabset-fade .tabset-pills}
**Стандартная ошибка количества ускорений за секунду**

#### Descriptive stat

```{r}
describeBy(acc_per_sec_se ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_per_sec_se"
plot_list <- draw_plots_continuous_by_group(df, var = acc_per_sec_se, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Стандартная ошибка количества ускорений за секунду", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$acc_per_sec_se);print(st)
check_normal_distribution(st)
ks <- ks.test(df$acc_per_sec_se, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(acc_per_sec_se)$statistic,
          p.value = shapiro.test(acc_per_sec_se)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = acc_per_sec_se)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - acc_per_sec_se", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$acc_per_sec_se)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$acc_per_sec_se, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$acc_per_sec_se, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "acc_per_sec_se")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_per_sec_se', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=acc_per_sec_se, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### acc_per_sec_q0.25 {.tabset .tabset-fade .tabset-pills}
**Нижний квартиль количества ускорений за секунду**

#### Descriptive stat

```{r}
describeBy(acc_per_sec_q0.25 ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_per_sec_q0.25"
plot_list <- draw_plots_continuous_by_group(df, var = acc_per_sec_q0.25, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Нижний квартиль количества ускорений за секунду", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$acc_per_sec_q0.25);print(st)
check_normal_distribution(st)
ks <- ks.test(df$acc_per_sec_q0.25, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(acc_per_sec_q0.25)$statistic,
          p.value = shapiro.test(acc_per_sec_q0.25)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = acc_per_sec_q0.25)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - acc_per_sec_q0.25", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$acc_per_sec_q0.25)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$acc_per_sec_q0.25, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$acc_per_sec_q0.25, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "acc_per_sec_q0.25")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_per_sec_q0.25', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=acc_per_sec_q0.25, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### acc_per_sec_q0.75 {.tabset .tabset-fade .tabset-pills}
**Верхний квартиль количества ускорений за секунду**

#### Descriptive stat

```{r}
describeBy(acc_per_sec_q0.75 ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_per_sec_q0.75"
plot_list <- draw_plots_continuous_by_group(df, var = acc_per_sec_q0.75, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Верхний квартиль количества ускорений за секунду", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$acc_per_sec_q0.75);print(st)
check_normal_distribution(st)
ks <- ks.test(df$acc_per_sec_q0.75, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(acc_per_sec_q0.75)$statistic,
          p.value = shapiro.test(acc_per_sec_q0.75)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = acc_per_sec_q0.75)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - acc_per_sec_q0.75", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$acc_per_sec_q0.75)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$acc_per_sec_q0.75, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$acc_per_sec_q0.75, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "acc_per_sec_q0.75")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_per_sec_q0.75', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=acc_per_sec_q0.75, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### acc_per_sec_max_pos {.tabset .tabset-fade .tabset-pills}
**Позиция максимального количества ускорений**

#### Descriptive stat

```{r}
describeBy(acc_per_sec_max_pos ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_per_sec_max_pos"
plot_list <- draw_plots_continuous_by_group(df, var = acc_per_sec_max_pos, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Позиция максимального количества ускорений", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$acc_per_sec_max_pos);print(st)
check_normal_distribution(st)
ks <- ks.test(df$acc_per_sec_max_pos, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(acc_per_sec_max_pos)$statistic,
          p.value = shapiro.test(acc_per_sec_max_pos)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = acc_per_sec_max_pos)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - acc_per_sec_max_pos", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$acc_per_sec_max_pos)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$acc_per_sec_max_pos, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$acc_per_sec_max_pos, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "acc_per_sec_max_pos")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_per_sec_max_pos', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=acc_per_sec_max_pos, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### acc_per_sec_min_pos {.tabset .tabset-fade .tabset-pills}
**Позиция минимального количества ускорений**

#### Descriptive stat

```{r}
describeBy(acc_per_sec_min_pos ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_per_sec_min_pos"
plot_list <- draw_plots_continuous_by_group(df, var = acc_per_sec_min_pos, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Позиция минимального количества ускорений", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$acc_per_sec_min_pos);print(st)
check_normal_distribution(st)
ks <- ks.test(df$acc_per_sec_min_pos, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(acc_per_sec_min_pos)$statistic,
          p.value = shapiro.test(acc_per_sec_min_pos)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = acc_per_sec_min_pos)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - acc_per_sec_min_pos", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$acc_per_sec_min_pos)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$acc_per_sec_min_pos, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$acc_per_sec_min_pos, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "acc_per_sec_min_pos")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_per_sec_min_pos', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=acc_per_sec_min_pos, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### missings_distance {.tabset .tabset-fade .tabset-pills}
**Расстояние промахов от центра мишеней, пикс.**

#### Descriptive stat

```{r}
describeBy(missings_distance ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "missings_distance"
plot_list <- draw_plots_continuous_by_group(df, var = missings_distance, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Расстояние промахов от центра мишеней, пикс.", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$missings_distance);print(st)
check_normal_distribution(st)
ks <- ks.test(df$missings_distance, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(missings_distance)$statistic,
          p.value = shapiro.test(missings_distance)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = missings_distance)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - missings_distance", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$missings_distance)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$missings_distance, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$missings_distance, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "missings_distance")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('missings_distance', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=missings_distance, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### missings_mean {.tabset .tabset-fade .tabset-pills}
**Среднее расстояние промахов от центра мишеней, пикс.**

#### Descriptive stat

```{r}
describeBy(missings_mean ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "missings_mean"
plot_list <- draw_plots_continuous_by_group(df, var = missings_mean, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Среднее расстояние промахов от центра мишеней, пикс.", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$missings_mean);print(st)
check_normal_distribution(st)
ks <- ks.test(df$missings_mean, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(missings_mean)$statistic,
          p.value = shapiro.test(missings_mean)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = missings_mean)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - missings_mean", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$missings_mean)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$missings_mean, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$missings_mean, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "missings_mean")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('missings_mean', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=missings_mean, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### missings_sd {.tabset .tabset-fade .tabset-pills}
**Стандартное отклонение расстояний промахов**

#### Descriptive stat

```{r}
describeBy(missings_sd ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "missings_sd"
plot_list <- draw_plots_continuous_by_group(df, var = missings_sd, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Стандартное отклонение расстояний промахов", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$missings_sd);print(st)
check_normal_distribution(st)
ks <- ks.test(df$missings_sd, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(missings_sd)$statistic,
          p.value = shapiro.test(missings_sd)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = missings_sd)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - missings_sd", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$missings_sd)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$missings_sd, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$missings_sd, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "missings_sd")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('missings_sd', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=missings_sd, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### missings_median {.tabset .tabset-fade .tabset-pills}
**Медиана расстояний промахов**

#### Descriptive stat

```{r}
describeBy(missings_median ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "missings_median"
plot_list <- draw_plots_continuous_by_group(df, var = missings_median, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Медиана расстояний промахов", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$missings_median);print(st)
check_normal_distribution(st)
ks <- ks.test(df$missings_median, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(missings_median)$statistic,
          p.value = shapiro.test(missings_median)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = missings_median)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - missings_median", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$missings_median)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$missings_median, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$missings_median, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "missings_median")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('missings_median', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=missings_median, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### missings_trimmed {.tabset .tabset-fade .tabset-pills}
**Усеченное среднее расстояний промахов**

#### Descriptive stat

```{r}
describeBy(missings_trimmed ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "missings_trimmed"
plot_list <- draw_plots_continuous_by_group(df, var = missings_trimmed, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Усеченное среднее расстояний промахов", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$missings_trimmed);print(st)
check_normal_distribution(st)
ks <- ks.test(df$missings_trimmed, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(missings_trimmed)$statistic,
          p.value = shapiro.test(missings_trimmed)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = missings_trimmed)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - missings_trimmed", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$missings_trimmed)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$missings_trimmed, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$missings_trimmed, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "missings_trimmed")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('missings_trimmed', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=missings_trimmed, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### missings_mad {.tabset .tabset-fade .tabset-pills}
**Среднее абсолютное отклонение расстояний промахов**

#### Descriptive stat

```{r}
describeBy(missings_mad ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "missings_mad"
plot_list <- draw_plots_continuous_by_group(df, var = missings_mad, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Среднее абсолютное отклонение расстояний промахов", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$missings_mad);print(st)
check_normal_distribution(st)
ks <- ks.test(df$missings_mad, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(missings_mad)$statistic,
          p.value = shapiro.test(missings_mad)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = missings_mad)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - missings_mad", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$missings_mad)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$missings_mad, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$missings_mad, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "missings_mad")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('missings_mad', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=missings_mad, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### missings_min {.tabset .tabset-fade .tabset-pills}
**Минимальное расстояние промахов**

#### Descriptive stat

```{r}
describeBy(missings_min ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "missings_min"
plot_list <- draw_plots_continuous_by_group(df, var = missings_min, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Минимальное расстояние промахов", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$missings_min);print(st)
check_normal_distribution(st)
ks <- ks.test(df$missings_min, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(missings_min)$statistic,
          p.value = shapiro.test(missings_min)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = missings_min)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - missings_min", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$missings_min)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$missings_min, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$missings_min, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "missings_min")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('missings_min', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=missings_min, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### missings_max {.tabset .tabset-fade .tabset-pills}
**Максимальное расстояние промахов**

#### Descriptive stat

```{r}
describeBy(missings_max ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "missings_max"
plot_list <- draw_plots_continuous_by_group(df, var = missings_max, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Максимальное расстояние промахов", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$missings_max);print(st)
check_normal_distribution(st)
ks <- ks.test(df$missings_max, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(missings_max)$statistic,
          p.value = shapiro.test(missings_max)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = missings_max)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - missings_max", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$missings_max)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$missings_max, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$missings_max, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "missings_max")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('missings_max', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=missings_max, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### missings_range {.tabset .tabset-fade .tabset-pills}
**Размах расстояния промахов**

#### Descriptive stat

```{r}
describeBy(missings_range ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "missings_range"
plot_list <- draw_plots_continuous_by_group(df, var = missings_range, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Размах расстояния промахов", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$missings_range);print(st)
check_normal_distribution(st)
ks <- ks.test(df$missings_range, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(missings_range)$statistic,
          p.value = shapiro.test(missings_range)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = missings_range)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - missings_range", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$missings_range)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$missings_range, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$missings_range, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "missings_range")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('missings_range', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=missings_range, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### missings_skew {.tabset .tabset-fade .tabset-pills}
**Коэффициент асимметрии расстояний промахов**

#### Descriptive stat

```{r}
describeBy(missings_skew ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "missings_skew"
plot_list <- draw_plots_continuous_by_group(df, var = missings_skew, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Коэффициент асимметрии расстояний промахов", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$missings_skew);print(st)
check_normal_distribution(st)
ks <- ks.test(df$missings_skew, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(missings_skew)$statistic,
          p.value = shapiro.test(missings_skew)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = missings_skew)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - missings_skew", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$missings_skew)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$missings_skew, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$missings_skew, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "missings_skew")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('missings_skew', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=missings_skew, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### missings_kurtosis {.tabset .tabset-fade .tabset-pills}
**Эксцесс расстояний промахов**

#### Descriptive stat

```{r}
describeBy(missings_kurtosis ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "missings_kurtosis"
plot_list <- draw_plots_continuous_by_group(df, var = missings_kurtosis, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Эксцесс расстояний промахов", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$missings_kurtosis);print(st)
check_normal_distribution(st)
ks <- ks.test(df$missings_kurtosis, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(missings_kurtosis)$statistic,
          p.value = shapiro.test(missings_kurtosis)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = missings_kurtosis)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - missings_kurtosis", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$missings_kurtosis)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$missings_kurtosis, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$missings_kurtosis, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "missings_kurtosis")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('missings_kurtosis', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=missings_kurtosis, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### missings_se {.tabset .tabset-fade .tabset-pills}
**Стандартная ошибка расстояний промахов**

#### Descriptive stat

```{r}
describeBy(missings_se ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "missings_se"
plot_list <- draw_plots_continuous_by_group(df, var = missings_se, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Стандартная ошибка расстояний промахов", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$missings_se);print(st)
check_normal_distribution(st)
ks <- ks.test(df$missings_se, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(missings_se)$statistic,
          p.value = shapiro.test(missings_se)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = missings_se)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - missings_se", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$missings_se)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$missings_se, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$missings_se, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "missings_se")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('missings_se', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=missings_se, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### missings_q0.25 {.tabset .tabset-fade .tabset-pills}
**Нижний квартиль расстояний промахов**

#### Descriptive stat

```{r}
describeBy(missings_q0.25 ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "missings_q0.25"
plot_list <- draw_plots_continuous_by_group(df, var = missings_q0.25, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Нижний квартиль расстояний промахов", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$missings_q0.25);print(st)
check_normal_distribution(st)
ks <- ks.test(df$missings_q0.25, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(missings_q0.25)$statistic,
          p.value = shapiro.test(missings_q0.25)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = missings_q0.25)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - missings_q0.25", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$missings_q0.25)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$missings_q0.25, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$missings_q0.25, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "missings_q0.25")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('missings_q0.25', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=missings_q0.25, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### missings_q0.75 {.tabset .tabset-fade .tabset-pills}
**Верхний квартиль расстояний промахов**

#### Descriptive stat

```{r}
describeBy(missings_q0.75 ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "missings_q0.75"
plot_list <- draw_plots_continuous_by_group(df, var = missings_q0.75, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Верхний квартиль расстояний промахов", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$missings_q0.75);print(st)
check_normal_distribution(st)
ks <- ks.test(df$missings_q0.75, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(missings_q0.75)$statistic,
          p.value = shapiro.test(missings_q0.75)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = missings_q0.75)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - missings_q0.75", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$missings_q0.75)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$missings_q0.75, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$missings_q0.75, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "missings_q0.75")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('missings_q0.75', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=missings_q0.75, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### missings {.tabset .tabset-fade .tabset-pills}
**Количество промахов, шт.**

#### Descriptive stat

```{r}
describeBy(missings ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "missings"
plot_list <- draw_plots_continuous_by_group(df, var = missings, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Количество промахов, шт.", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$missings);print(st)
check_normal_distribution(st)
ks <- ks.test(df$missings, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(missings)$statistic,
          p.value = shapiro.test(missings)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = missings)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - missings", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$missings)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$missings, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$missings, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "missings")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('missings', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=missings, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### hits {.tabset .tabset-fade .tabset-pills}
**Количество попаданий, шт.**

#### Descriptive stat

```{r}
describeBy(hits ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "hits"
plot_list <- draw_plots_continuous_by_group(df, var = hits, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Количество попаданий, шт.", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$hits);print(st)
check_normal_distribution(st)
ks <- ks.test(df$hits, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(hits)$statistic,
          p.value = shapiro.test(hits)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = hits)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - hits", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$hits)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$hits, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$hits, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "hits")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('hits', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=hits, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### missings_trend {.tabset .tabset-fade .tabset-pills}
**Линейный тренд расстояния промахов**

#### Descriptive stat

```{r}
describeBy(missings_trend ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "missings_trend"
plot_list <- draw_plots_continuous_by_group(df, var = missings_trend, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Линейный тренд расстояния промахов", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$missings_trend);print(st)
check_normal_distribution(st)
ks <- ks.test(df$missings_trend, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(missings_trend)$statistic,
          p.value = shapiro.test(missings_trend)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = missings_trend)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - missings_trend", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$missings_trend)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$missings_trend, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$missings_trend, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "missings_trend")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('missings_trend', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=missings_trend, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### accuracy_rate {.tabset .tabset-fade .tabset-pills}
**Точность, %**

#### Descriptive stat

```{r}
describeBy(accuracy_rate ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "accuracy_rate"
plot_list <- draw_plots_continuous_by_group(df, var = accuracy_rate, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Точность, %", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$accuracy_rate);print(st)
check_normal_distribution(st)
ks <- ks.test(df$accuracy_rate, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(accuracy_rate)$statistic,
          p.value = shapiro.test(accuracy_rate)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = accuracy_rate)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - accuracy_rate", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$accuracy_rate)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$accuracy_rate, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$accuracy_rate, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "accuracy_rate")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('accuracy_rate', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=accuracy_rate, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### combo_hits {.tabset .tabset-fade .tabset-pills}
**Комбо попаданий**

#### Descriptive stat

```{r}
describeBy(combo_hits ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "combo_hits"
plot_list <- draw_plots_continuous_by_group(df, var = combo_hits, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Комбо попаданий", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$combo_hits);print(st)
check_normal_distribution(st)
ks <- ks.test(df$combo_hits, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(combo_hits)$statistic,
          p.value = shapiro.test(combo_hits)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = combo_hits)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - combo_hits", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$combo_hits)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$combo_hits, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$combo_hits, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "combo_hits")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('combo_hits', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=combo_hits, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```






### combo_missings {.tabset .tabset-fade .tabset-pills}
**Комбо пропахов**

#### Descriptive stat

```{r}
describeBy(combo_missings ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "combo_missings"
plot_list <- draw_plots_continuous_by_group(df, var = combo_missings, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Комбо пропахов", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$combo_missings);print(st)
check_normal_distribution(st)
ks <- ks.test(df$combo_missings, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(combo_missings)$statistic,
          p.value = shapiro.test(combo_missings)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = combo_missings)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - combo_missings", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$combo_missings)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$combo_missings, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$combo_missings, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "combo_missings")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('combo_missings', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=combo_missings, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```
















### corr_sat {.tabset .tabset-fade .tabset-pills}
**Коэффициент корреляции скорости и точности**

#### Descriptive stat

```{r}
describeBy(corr_sat ~ notcorr_kmdclust3, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "corr_sat"
plot_list <- draw_plots_continuous_by_group(df, var = corr_sat, df$notcorr_kmdclust3, group_lab = "notcorr_kmdclust3", x_lab = "Коэффициент корреляции скорости и точности", title = plot_title)
create_tabs(plot_list)
```


#### Normal test
```{r}
st <- shapiro.test(df$corr_sat);print(st)
check_normal_distribution(st)
ks <- ks.test(df$corr_sat, "pnorm");print(ks)
check_normal_distribution(ks)
```

```{r}
tryCatch(
    expr = {
      df %>%
        group_by() %>%
        summarise(
          W = shapiro.test(corr_sat)$statistic,
          p.value = shapiro.test(corr_sat)$p.value,
          message = ifelse(p.value < 0.05, "Проверка на нормальность не пройдена", "Проверка на нормальность пройдена")
        )
    },
    error = function(e){
      print(e)
    }
)
```


```{r results='asis'}
p1 <- ggplot(df, aes(sample = corr_sat)) +  geom_qq(col=main_color) + geom_qq_line() + labs(title = "QQPlot - corr_sat", tabname="QQPlot", filename=paste0(plot_title, "_QQplot")) + facet_wrap(". ~ notcorr_kmdclust3")

create_tabs(list(p1))
```

#### Сравнение групп

```{r}
users_with_na <- df$user_id[is.na(df$corr_sat)]
df.test <- df[!df$user_id %in% users_with_na,]
df.test$user_id <- factor(df.test$user_id)

t_test_results <- pairwise.t.test(df.test$corr_sat, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");t_test_results
wilcox_test_results <- pairwise.wilcox.test(df.test$corr_sat, df.test$notcorr_kmdclust3, p.adjust.method = "bonferroni");wilcox_test_results
```

```{r results='asis'}
if (sum(wilcox_test_results$p.value <= 0.05, na.rm = T) > 0) {
  sign_differences <- c(sign_differences, "corr_sat")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('corr_sat', 'highlight');});</script>")
}
```

#### CI ~ notcorr_kmdclust3

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=notcorr_kmdclust3, y=corr_sat, color=notcorr_kmdclust3, group=notcorr_kmdclust3)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```







### Значимые различия
```{r results='asis'}
cat(paste0('<a href="#', sign_differences, '">', sign_differences, "</a><br>"))
```

