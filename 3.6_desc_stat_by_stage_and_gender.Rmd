---
title: "Описательная статистика"
author: "SVA"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  html_document:
    css: "styles.css"
    code_folding: hide
    df_print: paged
    toc: yes
    toc_depth: 4
    toc_float:
      collapsed: no
  word_document:
    toc: yes
    toc_depth: '4'
editor_options:
  chunk_output_type: inline
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  include = TRUE,
  message = FALSE, 
  warning = FALSE
)

rm(list=ls())
source("functions.R")
library("ARTool")
```
<script>
function addClassToTitle(containerId, className) {
  // Находим контейнер по id
  var container = document.getElementById(containerId);
  if (!container) {
    console.warn('Контейнер с id "' + containerId + '" не найден.');
    return;
  }

  // Добавляем класс к найденному h3
  container.classList.add(className);
}
</script>



```{r}
# Набор данных: Точность
df.acc <- read.csv("./data/accuracy_features.csv")

df.acc$acc_max[is.infinite(df.acc$acc_max)] <- NA
df.acc$acc_mean[is.infinite(df.acc$acc_mean)] <- NA
df.acc$acc_range[is.infinite(df.acc$acc_range)] <- NA

df.acc$dec_max[is.infinite(df.acc$dec_max)] <- NA
df.acc$dec_mean[is.infinite(df.acc$dec_mean)] <- NA
df.acc$dec_range[is.infinite(df.acc$dec_range)] <- NA

df.acc$X <- NULL
df.acc$stage <- "accuracy"

names(df.acc) <- tolower(names(df.acc))
```

```{r}
# Набор данных: Скорость
df.spd <- read.csv("./data/speed_features.csv")

df.spd$acc_max[is.infinite(df.spd$acc_max)] <- NA
df.spd$acc_mean[is.infinite(df.spd$acc_mean)] <- NA
df.spd$acc_range[is.infinite(df.spd$acc_range)] <- NA

df.spd$dec_max[is.infinite(df.spd$dec_max)] <- NA
df.spd$dec_mean[is.infinite(df.spd$dec_mean)] <- NA
df.spd$dec_range[is.infinite(df.spd$dec_range)] <- NA
df.spd$dec_min[is.infinite(df.spd$dec_min)] <- NA

df.spd$X <- NULL
df.spd$stage <- "speed"

names(df.spd) <- tolower(names(df.spd))
```

```{r}
## Кликеры
clickers.acc <- df.acc[df.acc$clicked_through_targets > 5 & df.acc$combo_clicked_through_targets > 5, ]
clickers.spd <- df.spd[df.spd$clicked_through_targets > 5 & df.spd$combo_clicked_through_targets > 5, ]
clickers <- unique(c(clickers.acc$user_id, clickers.spd$user_id))

df.acc <- df.acc[!df.acc$user_id %in% clickers, ]
df.spd <- df.spd[!df.spd$user_id %in% clickers, ]
```


```{r}
## Остановки во время выполнения теста (можно попробовать восстановить)
long_stops.acc <- df.acc[df.acc$time_max >= 10, ]
long_stops.spd <- df.spd[df.spd$time_max >= 10, ]
long_stops <- unique(c(long_stops.acc$user_id, long_stops.spd$user_id))

df.acc <- df.acc[!df.acc$user_id %in% long_stops, ]
df.spd <- df.spd[!df.spd$user_id %in% long_stops, ]
```

```{r}
## Данные тестов психодиагностики
sp_results <- read_xlsx("../../Все тесты/data/results/sp_results_impersonal.xlsx")
science_types <- read.csv("../../Все тесты/data/results/science_types.csv")

sp_results$science_type[sp_results$direction %in% science_types$direction[science_types$knowledge_field == "Natural Sciences"]] <- "Natural Sciences"
sp_results$science_type[sp_results$direction %in% science_types$direction[science_types$knowledge_field == "Social and Humanitarian Sciences"]] <- "Social and Humanitarian Sciences"
sp_results$science_type[sp_results$direction %in% science_types$direction[science_types$knowledge_field == "Technical Sciences"]] <- "Technical Sciences"

df.acc <- merge(df.acc, select(sp_results, userid, gender, science_type, direction), by.x = "user_id", by.y = "userid", all.x = T)
df.acc <- select(df.acc, 1:4, gender, science_type, direction, everything())
df.acc <- df.acc[!is.na(df.acc$gender),]

df.spd <- merge(df.spd, select(sp_results, userid, gender, science_type, direction), by.x = "user_id", by.y = "userid", all.x = T)
df.spd <- select(df.spd, 1:4, gender, science_type, direction, everything())
df.spd <- df.spd[!is.na(df.spd$gender),]
```

```{r}
## Длинный формат данных
df <- rbind(df.acc, df.spd)

df$gender <- factor(df$gender, labels = c("F", "M"))
df$direction <- factor(df$direction)
df$stage <- factor(df$stage, levels = c("accuracy", "speed"))
df$user_id <- factor(df$user_id)
```

```{r}
save(df, file = "./data/envs/1_desc_stat/df.RData")
save(df.acc, file = "./data/envs/1_desc_stat/df.acc.RData")
save(df.spd, file = "./data/envs/1_desc_stat/df.spd.RData")
save(sp_results, file = "./data/envs/1_desc_stat/sp_results.RData")
save(clickers, file = "./data/envs/1_desc_stat/clickers.RData")

```


```{r}
sign_differences <- vector()
```


# Описательные статистики


















### ratio {.tabset .tabset-fade .tabset-pills}
**ratio**

#### Tables

Распределение по переменной "ratio"

```{r}
tab <- table(df$ratio)

data.frame(
  level = names(tab),
  frequency = as.vector(tab),
  percent = as.vector(round(prop.table(tab) * 100, 2))
)
```







### gender {.tabset .tabset-fade .tabset-pills}
**Пол респондента**

#### Tables

Распределение по переменной "gender"

```{r}
tab <- table(df$gender)

data.frame(
  level = names(tab),
  frequency = as.vector(tab),
  percent = as.vector(round(prop.table(tab) * 100, 2))
)
```






### time_total {.tabset .tabset-fade .tabset-pills}
**Общее время выполнения**

#### Descriptive stat

```{r}
describeBy(time_total ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "time_total"
p1 <- ggplot(df, aes(time_total, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(time_total, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, time_total, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=time_total, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$time_total)]), ]
```

```{r}
aov_model <- aov(time_total ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(time_total ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "time_total")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('time_total', 'highlight');});</script>")
}

```







### time_mean {.tabset .tabset-fade .tabset-pills}
**Среднее время на клик**

#### Descriptive stat

```{r}
describeBy(time_mean ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "time_mean"
p1 <- ggplot(df, aes(time_mean, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(time_mean, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, time_mean, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=time_mean, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$time_mean)]), ]
```

```{r}
aov_model <- aov(time_mean ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(time_mean ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "time_mean")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('time_mean', 'highlight');});</script>")
}

```







### time_sd {.tabset .tabset-fade .tabset-pills}
**Стандартное отклонение времени на клик**

#### Descriptive stat

```{r}
describeBy(time_sd ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "time_sd"
p1 <- ggplot(df, aes(time_sd, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(time_sd, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, time_sd, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=time_sd, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$time_sd)]), ]
```

```{r}
aov_model <- aov(time_sd ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(time_sd ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "time_sd")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('time_sd', 'highlight');});</script>")
}

```







### time_median {.tabset .tabset-fade .tabset-pills}
**Медианное время на клик**

#### Descriptive stat

```{r}
describeBy(time_median ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "time_median"
p1 <- ggplot(df, aes(time_median, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(time_median, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, time_median, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=time_median, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$time_median)]), ]
```

```{r}
aov_model <- aov(time_median ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(time_median ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "time_median")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('time_median', 'highlight');});</script>")
}

```







### time_trimmed {.tabset .tabset-fade .tabset-pills}
**Усеченное среднее времени на клик**

#### Descriptive stat

```{r}
describeBy(time_trimmed ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "time_trimmed"
p1 <- ggplot(df, aes(time_trimmed, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(time_trimmed, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, time_trimmed, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=time_trimmed, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$time_trimmed)]), ]
```

```{r}
aov_model <- aov(time_trimmed ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(time_trimmed ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "time_trimmed")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('time_trimmed', 'highlight');});</script>")
}

```







### time_mad {.tabset .tabset-fade .tabset-pills}
**Среднее Абсолютное Отклонение времени на клик**

#### Descriptive stat

```{r}
describeBy(time_mad ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "time_mad"
p1 <- ggplot(df, aes(time_mad, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(time_mad, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, time_mad, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=time_mad, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$time_mad)]), ]
```

```{r}
aov_model <- aov(time_mad ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(time_mad ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "time_mad")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('time_mad', 'highlight');});</script>")
}

```







### time_min {.tabset .tabset-fade .tabset-pills}
**Минимальное время клика**

#### Descriptive stat

```{r}
describeBy(time_min ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "time_min"
p1 <- ggplot(df, aes(time_min, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(time_min, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, time_min, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=time_min, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$time_min)]), ]
```

```{r}
aov_model <- aov(time_min ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(time_min ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "time_min")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('time_min', 'highlight');});</script>")
}

```







### time_max {.tabset .tabset-fade .tabset-pills}
**Максимальное время клика**

#### Descriptive stat

```{r}
describeBy(time_max ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "time_max"
p1 <- ggplot(df, aes(time_max, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(time_max, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, time_max, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=time_max, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$time_max)]), ]
```

```{r}
aov_model <- aov(time_max ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(time_max ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "time_max")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('time_max', 'highlight');});</script>")
}

```







### time_range {.tabset .tabset-fade .tabset-pills}
**Размах времени на клик**

#### Descriptive stat

```{r}
describeBy(time_range ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "time_range"
p1 <- ggplot(df, aes(time_range, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(time_range, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, time_range, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=time_range, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$time_range)]), ]
```

```{r}
aov_model <- aov(time_range ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(time_range ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "time_range")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('time_range', 'highlight');});</script>")
}

```







### time_skew {.tabset .tabset-fade .tabset-pills}
**Коэффициент асимметрии времени выполнения**

#### Descriptive stat

```{r}
describeBy(time_skew ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "time_skew"
p1 <- ggplot(df, aes(time_skew, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(time_skew, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, time_skew, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=time_skew, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$time_skew)]), ]
```

```{r}
aov_model <- aov(time_skew ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(time_skew ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "time_skew")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('time_skew', 'highlight');});</script>")
}

```







### time_kurtosis {.tabset .tabset-fade .tabset-pills}
**Эксцесс времени выполнения**

#### Descriptive stat

```{r}
describeBy(time_kurtosis ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "time_kurtosis"
p1 <- ggplot(df, aes(time_kurtosis, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(time_kurtosis, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, time_kurtosis, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=time_kurtosis, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$time_kurtosis)]), ]
```

```{r}
aov_model <- aov(time_kurtosis ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(time_kurtosis ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "time_kurtosis")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('time_kurtosis', 'highlight');});</script>")
}

```







### time_se {.tabset .tabset-fade .tabset-pills}
**Стандартная ошибка среднего времени выполнения**

#### Descriptive stat

```{r}
describeBy(time_se ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "time_se"
p1 <- ggplot(df, aes(time_se, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(time_se, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, time_se, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=time_se, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$time_se)]), ]
```

```{r}
aov_model <- aov(time_se ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(time_se ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "time_se")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('time_se', 'highlight');});</script>")
}

```







### time_q0.25 {.tabset .tabset-fade .tabset-pills}
**Нижний квартиль времени выполнения**

#### Descriptive stat

```{r}
describeBy(time_q0.25 ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "time_q0.25"
p1 <- ggplot(df, aes(time_q0.25, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(time_q0.25, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, time_q0.25, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=time_q0.25, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$time_q0.25)]), ]
```

```{r}
aov_model <- aov(time_q0.25 ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(time_q0.25 ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "time_q0.25")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('time_q0.25', 'highlight');});</script>")
}

```







### time_q0.75 {.tabset .tabset-fade .tabset-pills}
**Верхний квартиль времени выполнения**

#### Descriptive stat

```{r}
describeBy(time_q0.75 ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "time_q0.75"
p1 <- ggplot(df, aes(time_q0.75, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(time_q0.75, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, time_q0.75, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=time_q0.75, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$time_q0.75)]), ]
```

```{r}
aov_model <- aov(time_q0.75 ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(time_q0.75 ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "time_q0.75")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('time_q0.75', 'highlight');});</script>")
}

```







### time_trend {.tabset .tabset-fade .tabset-pills}
**Линейный тренд времени выполнения**

#### Descriptive stat

```{r}
describeBy(time_trend ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "time_trend"
p1 <- ggplot(df, aes(time_trend, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(time_trend, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, time_trend, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=time_trend, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$time_trend)]), ]
```

```{r}
aov_model <- aov(time_trend ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(time_trend ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "time_trend")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('time_trend', 'highlight');});</script>")
}

```







### fitts_a {.tabset .tabset-fade .tabset-pills}
**Коэффициент a в формуле Фиттса**

#### Descriptive stat

```{r}
describeBy(fitts_a ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "fitts_a"
p1 <- ggplot(df, aes(fitts_a, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(fitts_a, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, fitts_a, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=fitts_a, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$fitts_a)]), ]
```

```{r}
aov_model <- aov(fitts_a ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(fitts_a ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "fitts_a")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('fitts_a', 'highlight');});</script>")
}

```







### fitts_b {.tabset .tabset-fade .tabset-pills}
**Коэффициент b в формуле Фиттса**

#### Descriptive stat

```{r}
describeBy(fitts_b ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "fitts_b"
p1 <- ggplot(df, aes(fitts_b, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(fitts_b, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, fitts_b, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=fitts_b, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$fitts_b)]), ]
```

```{r}
aov_model <- aov(fitts_b ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(fitts_b ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "fitts_b")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('fitts_b', 'highlight');});</script>")
}

```







### distance_total {.tabset .tabset-fade .tabset-pills}
**Общая амплитуда**

#### Descriptive stat

```{r}
describeBy(distance_total ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "distance_total"
p1 <- ggplot(df, aes(distance_total, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(distance_total, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, distance_total, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=distance_total, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$distance_total)]), ]
```

```{r}
aov_model <- aov(distance_total ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(distance_total ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "distance_total")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('distance_total', 'highlight');});</script>")
}

```







### distance_mean {.tabset .tabset-fade .tabset-pills}
**Средняя амплитуда на клик**

#### Descriptive stat

```{r}
describeBy(distance_mean ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "distance_mean"
p1 <- ggplot(df, aes(distance_mean, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(distance_mean, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, distance_mean, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=distance_mean, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$distance_mean)]), ]
```

```{r}
aov_model <- aov(distance_mean ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(distance_mean ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "distance_mean")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('distance_mean', 'highlight');});</script>")
}

```







### distance_sd {.tabset .tabset-fade .tabset-pills}
**Стандартное отклонение амплитуда на клик**

#### Descriptive stat

```{r}
describeBy(distance_sd ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "distance_sd"
p1 <- ggplot(df, aes(distance_sd, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(distance_sd, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, distance_sd, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=distance_sd, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$distance_sd)]), ]
```

```{r}
aov_model <- aov(distance_sd ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(distance_sd ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "distance_sd")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('distance_sd', 'highlight');});</script>")
}

```







### distance_median {.tabset .tabset-fade .tabset-pills}
**Медианная амплитуда на клик**

#### Descriptive stat

```{r}
describeBy(distance_median ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "distance_median"
p1 <- ggplot(df, aes(distance_median, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(distance_median, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, distance_median, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=distance_median, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$distance_median)]), ]
```

```{r}
aov_model <- aov(distance_median ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(distance_median ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "distance_median")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('distance_median', 'highlight');});</script>")
}

```







### distance_trimmed {.tabset .tabset-fade .tabset-pills}
**Усеченное среднее амплитуды на клик**

#### Descriptive stat

```{r}
describeBy(distance_trimmed ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "distance_trimmed"
p1 <- ggplot(df, aes(distance_trimmed, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(distance_trimmed, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, distance_trimmed, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=distance_trimmed, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$distance_trimmed)]), ]
```

```{r}
aov_model <- aov(distance_trimmed ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(distance_trimmed ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "distance_trimmed")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('distance_trimmed', 'highlight');});</script>")
}

```







### distance_mad {.tabset .tabset-fade .tabset-pills}
**Среднее Абсолютное Отклонение амплитуды на клик**

#### Descriptive stat

```{r}
describeBy(distance_mad ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "distance_mad"
p1 <- ggplot(df, aes(distance_mad, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(distance_mad, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, distance_mad, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=distance_mad, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$distance_mad)]), ]
```

```{r}
aov_model <- aov(distance_mad ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(distance_mad ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "distance_mad")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('distance_mad', 'highlight');});</script>")
}

```







### distance_min {.tabset .tabset-fade .tabset-pills}
**Минимальная амплитуда клика**

#### Descriptive stat

```{r}
describeBy(distance_min ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "distance_min"
p1 <- ggplot(df, aes(distance_min, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(distance_min, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, distance_min, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=distance_min, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$distance_min)]), ]
```

```{r}
aov_model <- aov(distance_min ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(distance_min ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "distance_min")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('distance_min', 'highlight');});</script>")
}

```







### distance_max {.tabset .tabset-fade .tabset-pills}
**Максимальная амплитуда клика**

#### Descriptive stat

```{r}
describeBy(distance_max ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "distance_max"
p1 <- ggplot(df, aes(distance_max, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(distance_max, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, distance_max, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=distance_max, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$distance_max)]), ]
```

```{r}
aov_model <- aov(distance_max ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(distance_max ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "distance_max")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('distance_max', 'highlight');});</script>")
}

```







### distance_range {.tabset .tabset-fade .tabset-pills}
**Размах амплитуды на клик**

#### Descriptive stat

```{r}
describeBy(distance_range ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "distance_range"
p1 <- ggplot(df, aes(distance_range, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(distance_range, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, distance_range, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=distance_range, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$distance_range)]), ]
```

```{r}
aov_model <- aov(distance_range ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(distance_range ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "distance_range")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('distance_range', 'highlight');});</script>")
}

```







### distance_skew {.tabset .tabset-fade .tabset-pills}
**Коэффициент асимметрии амплитуды**

#### Descriptive stat

```{r}
describeBy(distance_skew ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "distance_skew"
p1 <- ggplot(df, aes(distance_skew, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(distance_skew, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, distance_skew, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=distance_skew, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$distance_skew)]), ]
```

```{r}
aov_model <- aov(distance_skew ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(distance_skew ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "distance_skew")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('distance_skew', 'highlight');});</script>")
}

```







### distance_kurtosis {.tabset .tabset-fade .tabset-pills}
**Эксцесс амплитуды**

#### Descriptive stat

```{r}
describeBy(distance_kurtosis ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "distance_kurtosis"
p1 <- ggplot(df, aes(distance_kurtosis, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(distance_kurtosis, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, distance_kurtosis, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=distance_kurtosis, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$distance_kurtosis)]), ]
```

```{r}
aov_model <- aov(distance_kurtosis ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(distance_kurtosis ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "distance_kurtosis")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('distance_kurtosis', 'highlight');});</script>")
}

```







### distance_se {.tabset .tabset-fade .tabset-pills}
**Стандартная ошибка среднего амплитуды**

#### Descriptive stat

```{r}
describeBy(distance_se ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "distance_se"
p1 <- ggplot(df, aes(distance_se, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(distance_se, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, distance_se, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=distance_se, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$distance_se)]), ]
```

```{r}
aov_model <- aov(distance_se ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(distance_se ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "distance_se")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('distance_se', 'highlight');});</script>")
}

```







### distance_q0.25 {.tabset .tabset-fade .tabset-pills}
**Нижний квартиль амплитуды**

#### Descriptive stat

```{r}
describeBy(distance_q0.25 ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "distance_q0.25"
p1 <- ggplot(df, aes(distance_q0.25, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(distance_q0.25, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, distance_q0.25, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=distance_q0.25, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$distance_q0.25)]), ]
```

```{r}
aov_model <- aov(distance_q0.25 ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(distance_q0.25 ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "distance_q0.25")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('distance_q0.25', 'highlight');});</script>")
}

```







### distance_q0.75 {.tabset .tabset-fade .tabset-pills}
**Верхний квартиль амплитуды**

#### Descriptive stat

```{r}
describeBy(distance_q0.75 ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "distance_q0.75"
p1 <- ggplot(df, aes(distance_q0.75, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(distance_q0.75, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, distance_q0.75, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=distance_q0.75, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$distance_q0.75)]), ]
```

```{r}
aov_model <- aov(distance_q0.75 ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(distance_q0.75 ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "distance_q0.75")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('distance_q0.75', 'highlight');});</script>")
}

```







### distance_trend {.tabset .tabset-fade .tabset-pills}
**Линейный тренд амплитуды**

#### Descriptive stat

```{r}
describeBy(distance_trend ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "distance_trend"
p1 <- ggplot(df, aes(distance_trend, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(distance_trend, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, distance_trend, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=distance_trend, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$distance_trend)]), ]
```

```{r}
aov_model <- aov(distance_trend ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(distance_trend ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "distance_trend")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('distance_trend', 'highlight');});</script>")
}

```







### pause_total {.tabset .tabset-fade .tabset-pills}
**Общее время пауз**

#### Descriptive stat

```{r}
describeBy(pause_total ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "pause_total"
p1 <- ggplot(df, aes(pause_total, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(pause_total, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, pause_total, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=pause_total, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$pause_total)]), ]
```

```{r}
aov_model <- aov(pause_total ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(pause_total ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "pause_total")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('pause_total', 'highlight');});</script>")
}

```







### pause_number {.tabset .tabset-fade .tabset-pills}
**Количество пауз**

#### Descriptive stat

```{r}
describeBy(pause_number ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "pause_number"
p1 <- ggplot(df, aes(pause_number, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(pause_number, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, pause_number, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=pause_number, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$pause_number)]), ]
```

```{r}
aov_model <- aov(pause_number ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(pause_number ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "pause_number")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('pause_number', 'highlight');});</script>")
}

```







### pause_mean {.tabset .tabset-fade .tabset-pills}
**Среднее пауза**

#### Descriptive stat

```{r}
describeBy(pause_mean ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "pause_mean"
p1 <- ggplot(df, aes(pause_mean, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(pause_mean, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, pause_mean, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=pause_mean, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$pause_mean)]), ]
```

```{r}
aov_model <- aov(pause_mean ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(pause_mean ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "pause_mean")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('pause_mean', 'highlight');});</script>")
}

```







### pause_sd {.tabset .tabset-fade .tabset-pills}
**Стандартное отклонение пауз**

#### Descriptive stat

```{r}
describeBy(pause_sd ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "pause_sd"
p1 <- ggplot(df, aes(pause_sd, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(pause_sd, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, pause_sd, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=pause_sd, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$pause_sd)]), ]
```

```{r}
aov_model <- aov(pause_sd ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(pause_sd ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "pause_sd")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('pause_sd', 'highlight');});</script>")
}

```







### pause_median {.tabset .tabset-fade .tabset-pills}
**Медианная пауза**

#### Descriptive stat

```{r}
describeBy(pause_median ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "pause_median"
p1 <- ggplot(df, aes(pause_median, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(pause_median, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, pause_median, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=pause_median, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$pause_median)]), ]
```

```{r}
aov_model <- aov(pause_median ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(pause_median ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "pause_median")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('pause_median', 'highlight');});</script>")
}

```







### pause_trimmed {.tabset .tabset-fade .tabset-pills}
**Усеченное среднее пауз**

#### Descriptive stat

```{r}
describeBy(pause_trimmed ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "pause_trimmed"
p1 <- ggplot(df, aes(pause_trimmed, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(pause_trimmed, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, pause_trimmed, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=pause_trimmed, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$pause_trimmed)]), ]
```

```{r}
aov_model <- aov(pause_trimmed ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(pause_trimmed ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "pause_trimmed")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('pause_trimmed', 'highlight');});</script>")
}

```







### pause_mad {.tabset .tabset-fade .tabset-pills}
**Среднее Абсолютное Отклонение пауз**

#### Descriptive stat

```{r}
describeBy(pause_mad ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "pause_mad"
p1 <- ggplot(df, aes(pause_mad, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(pause_mad, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, pause_mad, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=pause_mad, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$pause_mad)]), ]
```

```{r}
aov_model <- aov(pause_mad ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(pause_mad ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "pause_mad")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('pause_mad', 'highlight');});</script>")
}

```







### pause_min {.tabset .tabset-fade .tabset-pills}
**Минимальное время паузы**

#### Descriptive stat

```{r}
describeBy(pause_min ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "pause_min"
p1 <- ggplot(df, aes(pause_min, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(pause_min, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, pause_min, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=pause_min, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$pause_min)]), ]
```

```{r}
aov_model <- aov(pause_min ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(pause_min ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "pause_min")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('pause_min', 'highlight');});</script>")
}

```







### pause_max {.tabset .tabset-fade .tabset-pills}
**Максимальное время паузы**

#### Descriptive stat

```{r}
describeBy(pause_max ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "pause_max"
p1 <- ggplot(df, aes(pause_max, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(pause_max, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, pause_max, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=pause_max, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$pause_max)]), ]
```

```{r}
aov_model <- aov(pause_max ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(pause_max ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "pause_max")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('pause_max', 'highlight');});</script>")
}

```







### pause_range {.tabset .tabset-fade .tabset-pills}
**Размах пауз**

#### Descriptive stat

```{r}
describeBy(pause_range ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "pause_range"
p1 <- ggplot(df, aes(pause_range, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(pause_range, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, pause_range, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=pause_range, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$pause_range)]), ]
```

```{r}
aov_model <- aov(pause_range ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(pause_range ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "pause_range")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('pause_range', 'highlight');});</script>")
}

```







### pause_skew {.tabset .tabset-fade .tabset-pills}
**Коэффициент асимметрии пауз**

#### Descriptive stat

```{r}
describeBy(pause_skew ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "pause_skew"
p1 <- ggplot(df, aes(pause_skew, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(pause_skew, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, pause_skew, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=pause_skew, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$pause_skew)]), ]
```

```{r}
aov_model <- aov(pause_skew ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(pause_skew ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "pause_skew")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('pause_skew', 'highlight');});</script>")
}

```







### pause_kurtosis {.tabset .tabset-fade .tabset-pills}
**Эксцесс пауз**

#### Descriptive stat

```{r}
describeBy(pause_kurtosis ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "pause_kurtosis"
p1 <- ggplot(df, aes(pause_kurtosis, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(pause_kurtosis, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, pause_kurtosis, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=pause_kurtosis, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$pause_kurtosis)]), ]
```

```{r}
aov_model <- aov(pause_kurtosis ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(pause_kurtosis ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "pause_kurtosis")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('pause_kurtosis', 'highlight');});</script>")
}

```







### pause_se {.tabset .tabset-fade .tabset-pills}
**Стандартная ошибка пауз**

#### Descriptive stat

```{r}
describeBy(pause_se ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "pause_se"
p1 <- ggplot(df, aes(pause_se, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(pause_se, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, pause_se, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=pause_se, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$pause_se)]), ]
```

```{r}
aov_model <- aov(pause_se ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(pause_se ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "pause_se")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('pause_se', 'highlight');});</script>")
}

```







### pause_q0.25 {.tabset .tabset-fade .tabset-pills}
**Нижний квартиль пауз**

#### Descriptive stat

```{r}
describeBy(pause_q0.25 ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "pause_q0.25"
p1 <- ggplot(df, aes(pause_q0.25, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(pause_q0.25, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, pause_q0.25, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=pause_q0.25, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$pause_q0.25)]), ]
```

```{r}
aov_model <- aov(pause_q0.25 ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(pause_q0.25 ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "pause_q0.25")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('pause_q0.25', 'highlight');});</script>")
}

```







### pause_q0.75 {.tabset .tabset-fade .tabset-pills}
**Верхний квартиль пауз**

#### Descriptive stat

```{r}
describeBy(pause_q0.75 ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "pause_q0.75"
p1 <- ggplot(df, aes(pause_q0.75, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(pause_q0.75, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, pause_q0.75, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=pause_q0.75, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$pause_q0.75)]), ]
```

```{r}
aov_model <- aov(pause_q0.75 ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(pause_q0.75 ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "pause_q0.75")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('pause_q0.75', 'highlight');});</script>")
}

```







### pause_trend {.tabset .tabset-fade .tabset-pills}
**Линейный тренд пауз**

#### Descriptive stat

```{r}
describeBy(pause_trend ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "pause_trend"
p1 <- ggplot(df, aes(pause_trend, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(pause_trend, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, pause_trend, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=pause_trend, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$pause_trend)]), ]
```

```{r}
aov_model <- aov(pause_trend ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(pause_trend ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "pause_trend")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('pause_trend', 'highlight');});</script>")
}

```







### stops {.tabset .tabset-fade .tabset-pills}
**Количество остановок**

#### Descriptive stat

```{r}
describeBy(stops ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "stops"
p1 <- ggplot(df, aes(stops, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(stops, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, stops, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=stops, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$stops)]), ]
```

```{r}
aov_model <- aov(stops ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(stops ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "stops")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('stops', 'highlight');});</script>")
}

```







### velocity_mean {.tabset .tabset-fade .tabset-pills}
**Средняя гармоническая скорость**

#### Descriptive stat

```{r}
describeBy(velocity_mean ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "velocity_mean"
p1 <- ggplot(df, aes(velocity_mean, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(velocity_mean, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, velocity_mean, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=velocity_mean, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$velocity_mean)]), ]
```

```{r}
aov_model <- aov(velocity_mean ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(velocity_mean ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "velocity_mean")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('velocity_mean', 'highlight');});</script>")
}

```







### velocity_sd {.tabset .tabset-fade .tabset-pills}
**Стандартное отклонение скорости**

#### Descriptive stat

```{r}
describeBy(velocity_sd ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "velocity_sd"
p1 <- ggplot(df, aes(velocity_sd, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(velocity_sd, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, velocity_sd, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=velocity_sd, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$velocity_sd)]), ]
```

```{r}
aov_model <- aov(velocity_sd ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(velocity_sd ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "velocity_sd")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('velocity_sd', 'highlight');});</script>")
}

```







### velocity_mad {.tabset .tabset-fade .tabset-pills}
**Среднее абсолютное отклонение скорости**

#### Descriptive stat

```{r}
describeBy(velocity_mad ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "velocity_mad"
p1 <- ggplot(df, aes(velocity_mad, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(velocity_mad, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, velocity_mad, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=velocity_mad, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$velocity_mad)]), ]
```

```{r}
aov_model <- aov(velocity_mad ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(velocity_mad ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "velocity_mad")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('velocity_mad', 'highlight');});</script>")
}

```







### velocity_min {.tabset .tabset-fade .tabset-pills}
**Минимальная скорость**

#### Descriptive stat

```{r}
describeBy(velocity_min ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "velocity_min"
p1 <- ggplot(df, aes(velocity_min, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(velocity_min, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, velocity_min, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=velocity_min, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$velocity_min)]), ]
```

```{r}
aov_model <- aov(velocity_min ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(velocity_min ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "velocity_min")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('velocity_min', 'highlight');});</script>")
}

```







### velocity_max {.tabset .tabset-fade .tabset-pills}
**Максимальная скорость**

#### Descriptive stat

```{r}
describeBy(velocity_max ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "velocity_max"
p1 <- ggplot(df, aes(velocity_max, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(velocity_max, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, velocity_max, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=velocity_max, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$velocity_max)]), ]
```

```{r}
aov_model <- aov(velocity_max ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(velocity_max ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "velocity_max")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('velocity_max', 'highlight');});</script>")
}

```







### velocity_range {.tabset .tabset-fade .tabset-pills}
**Размах скорости**

#### Descriptive stat

```{r}
describeBy(velocity_range ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "velocity_range"
p1 <- ggplot(df, aes(velocity_range, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(velocity_range, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, velocity_range, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=velocity_range, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$velocity_range)]), ]
```

```{r}
aov_model <- aov(velocity_range ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(velocity_range ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "velocity_range")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('velocity_range', 'highlight');});</script>")
}

```







### velocity_skew {.tabset .tabset-fade .tabset-pills}
**Коэффициент асимметрии скорости**

#### Descriptive stat

```{r}
describeBy(velocity_skew ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "velocity_skew"
p1 <- ggplot(df, aes(velocity_skew, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(velocity_skew, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, velocity_skew, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=velocity_skew, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$velocity_skew)]), ]
```

```{r}
aov_model <- aov(velocity_skew ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(velocity_skew ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "velocity_skew")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('velocity_skew', 'highlight');});</script>")
}

```







### velocity_kurtosis {.tabset .tabset-fade .tabset-pills}
**Эксцесс скорости**

#### Descriptive stat

```{r}
describeBy(velocity_kurtosis ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "velocity_kurtosis"
p1 <- ggplot(df, aes(velocity_kurtosis, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(velocity_kurtosis, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, velocity_kurtosis, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=velocity_kurtosis, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$velocity_kurtosis)]), ]
```

```{r}
aov_model <- aov(velocity_kurtosis ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(velocity_kurtosis ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "velocity_kurtosis")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('velocity_kurtosis', 'highlight');});</script>")
}

```







### velocity_se {.tabset .tabset-fade .tabset-pills}
**Стандартная ошибка скорости**

#### Descriptive stat

```{r}
describeBy(velocity_se ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "velocity_se"
p1 <- ggplot(df, aes(velocity_se, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(velocity_se, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, velocity_se, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=velocity_se, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$velocity_se)]), ]
```

```{r}
aov_model <- aov(velocity_se ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(velocity_se ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "velocity_se")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('velocity_se', 'highlight');});</script>")
}

```







### velocity_q0.25 {.tabset .tabset-fade .tabset-pills}
**Нижний квартиль скорости**

#### Descriptive stat

```{r}
describeBy(velocity_q0.25 ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "velocity_q0.25"
p1 <- ggplot(df, aes(velocity_q0.25, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(velocity_q0.25, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, velocity_q0.25, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=velocity_q0.25, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$velocity_q0.25)]), ]
```

```{r}
aov_model <- aov(velocity_q0.25 ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(velocity_q0.25 ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "velocity_q0.25")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('velocity_q0.25', 'highlight');});</script>")
}

```







### velocity_q0.75 {.tabset .tabset-fade .tabset-pills}
**Верхний квартиль скорости**

#### Descriptive stat

```{r}
describeBy(velocity_q0.75 ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "velocity_q0.75"
p1 <- ggplot(df, aes(velocity_q0.75, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(velocity_q0.75, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, velocity_q0.75, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=velocity_q0.75, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$velocity_q0.75)]), ]
```

```{r}
aov_model <- aov(velocity_q0.75 ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(velocity_q0.75 ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "velocity_q0.75")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('velocity_q0.75', 'highlight');});</script>")
}

```







### velocity_trend {.tabset .tabset-fade .tabset-pills}
**Линейный тренд скорости**

#### Descriptive stat

```{r}
describeBy(velocity_trend ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "velocity_trend"
p1 <- ggplot(df, aes(velocity_trend, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(velocity_trend, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, velocity_trend, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=velocity_trend, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$velocity_trend)]), ]
```

```{r}
aov_model <- aov(velocity_trend ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(velocity_trend ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "velocity_trend")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('velocity_trend', 'highlight');});</script>")
}

```







### acc_n {.tabset .tabset-fade .tabset-pills}
**Количество ускорений**

#### Descriptive stat

```{r}
describeBy(acc_n ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_n"
p1 <- ggplot(df, aes(acc_n, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(acc_n, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, acc_n, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=acc_n, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$acc_n)]), ]
```

```{r}
aov_model <- aov(acc_n ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(acc_n ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "acc_n")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_n', 'highlight');});</script>")
}

```












### acc_sd {.tabset .tabset-fade .tabset-pills}
**Стандартное отклонение ускорений**

#### Descriptive stat

```{r}
describeBy(acc_sd ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_sd"
p1 <- ggplot(df, aes(acc_sd, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(acc_sd, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, acc_sd, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=acc_sd, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$acc_sd)]), ]
```

```{r}
aov_model <- aov(acc_sd ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(acc_sd ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "acc_sd")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_sd', 'highlight');});</script>")
}

```







### acc_median {.tabset .tabset-fade .tabset-pills}
**Медианная ускорение**

#### Descriptive stat

```{r}
describeBy(acc_median ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_median"
p1 <- ggplot(df, aes(acc_median, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(acc_median, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, acc_median, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=acc_median, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$acc_median)]), ]
```

```{r}
aov_model <- aov(acc_median ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(acc_median ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "acc_median")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_median', 'highlight');});</script>")
}

```







### acc_trimmed {.tabset .tabset-fade .tabset-pills}
**Усеченное среднее ускорения**

#### Descriptive stat

```{r}
describeBy(acc_trimmed ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_trimmed"
p1 <- ggplot(df, aes(acc_trimmed, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(acc_trimmed, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, acc_trimmed, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=acc_trimmed, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$acc_trimmed)]), ]
```

```{r}
aov_model <- aov(acc_trimmed ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(acc_trimmed ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "acc_trimmed")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_trimmed', 'highlight');});</script>")
}

```







### acc_mad {.tabset .tabset-fade .tabset-pills}
**Среднее абсолютное отклонение ускорений**

#### Descriptive stat

```{r}
describeBy(acc_mad ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_mad"
p1 <- ggplot(df, aes(acc_mad, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(acc_mad, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, acc_mad, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=acc_mad, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$acc_mad)]), ]
```

```{r}
aov_model <- aov(acc_mad ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(acc_mad ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "acc_mad")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_mad', 'highlight');});</script>")
}

```







### acc_min {.tabset .tabset-fade .tabset-pills}
**Минимальное ускорение**

#### Descriptive stat

```{r}
describeBy(acc_min ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_min"
p1 <- ggplot(df, aes(acc_min, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(acc_min, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, acc_min, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=acc_min, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$acc_min)]), ]
```

```{r}
aov_model <- aov(acc_min ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(acc_min ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "acc_min")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_min', 'highlight');});</script>")
}

```







### acc_max {.tabset .tabset-fade .tabset-pills}
**Максимальное ускорение**

#### Descriptive stat

```{r}
describeBy(acc_max ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_max"
p1 <- ggplot(df, aes(acc_max, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(acc_max, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, acc_max, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=acc_max, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$acc_max)]), ]
```

```{r}
aov_model <- aov(acc_max ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(acc_max ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "acc_max")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_max', 'highlight');});</script>")
}

```







### acc_range {.tabset .tabset-fade .tabset-pills}
**Размах ускорений**

#### Descriptive stat

```{r}
describeBy(acc_range ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_range"
p1 <- ggplot(df, aes(acc_range, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(acc_range, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, acc_range, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=acc_range, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$acc_range)]), ]
```

```{r}
aov_model <- aov(acc_range ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(acc_range ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "acc_range")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_range', 'highlight');});</script>")
}

```







### acc_skew {.tabset .tabset-fade .tabset-pills}
**Коэффициент асимметрии ускорений**

#### Descriptive stat

```{r}
describeBy(acc_skew ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_skew"
p1 <- ggplot(df, aes(acc_skew, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(acc_skew, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, acc_skew, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=acc_skew, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$acc_skew)]), ]
```

```{r}
aov_model <- aov(acc_skew ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(acc_skew ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "acc_skew")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_skew', 'highlight');});</script>")
}

```







### acc_kurtosis {.tabset .tabset-fade .tabset-pills}
**Эксцесс ускорений**

#### Descriptive stat

```{r}
describeBy(acc_kurtosis ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_kurtosis"
p1 <- ggplot(df, aes(acc_kurtosis, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(acc_kurtosis, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, acc_kurtosis, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=acc_kurtosis, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$acc_kurtosis)]), ]
```

```{r}
aov_model <- aov(acc_kurtosis ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(acc_kurtosis ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "acc_kurtosis")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_kurtosis', 'highlight');});</script>")
}

```







### acc_se {.tabset .tabset-fade .tabset-pills}
**Стандартная ошибка ускорений**

#### Descriptive stat

```{r}
describeBy(acc_se ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_se"
p1 <- ggplot(df, aes(acc_se, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(acc_se, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, acc_se, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=acc_se, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$acc_se)]), ]
```

```{r}
aov_model <- aov(acc_se ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(acc_se ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "acc_se")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_se', 'highlight');});</script>")
}

```







### acc_q0.25 {.tabset .tabset-fade .tabset-pills}
**Нижний квартиль ускорений**

#### Descriptive stat

```{r}
describeBy(acc_q0.25 ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_q0.25"
p1 <- ggplot(df, aes(acc_q0.25, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(acc_q0.25, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, acc_q0.25, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=acc_q0.25, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$acc_q0.25)]), ]
```

```{r}
aov_model <- aov(acc_q0.25 ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(acc_q0.25 ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "acc_q0.25")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_q0.25', 'highlight');});</script>")
}

```







### acc_q0.75 {.tabset .tabset-fade .tabset-pills}
**Верхний квартиль ускорений**

#### Descriptive stat

```{r}
describeBy(acc_q0.75 ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_q0.75"
p1 <- ggplot(df, aes(acc_q0.75, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(acc_q0.75, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, acc_q0.75, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=acc_q0.75, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$acc_q0.75)]), ]
```

```{r}
aov_model <- aov(acc_q0.75 ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(acc_q0.75 ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "acc_q0.75")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_q0.75', 'highlight');});</script>")
}

```







### jerk_line {.tabset .tabset-fade .tabset-pills}
**Линия рывков**

#### Descriptive stat

```{r}
describeBy(jerk_line ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "jerk_line"
p1 <- ggplot(df, aes(jerk_line, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(jerk_line, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, jerk_line, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=jerk_line, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$jerk_line)]), ]
```

```{r}
aov_model <- aov(jerk_line ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(jerk_line ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "jerk_line")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('jerk_line', 'highlight');});</script>")
}

```







### n_jerk {.tabset .tabset-fade .tabset-pills}
**Количество рывков**

#### Descriptive stat

```{r}
describeBy(n_jerk ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "n_jerk"
p1 <- ggplot(df, aes(n_jerk, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(n_jerk, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, n_jerk, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=n_jerk, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$n_jerk)]), ]
```

```{r}
aov_model <- aov(n_jerk ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(n_jerk ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "n_jerk")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('n_jerk', 'highlight');});</script>")
}

```







### dec_n {.tabset .tabset-fade .tabset-pills}
**Количество замедлений**

#### Descriptive stat

```{r}
describeBy(dec_n ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "dec_n"
p1 <- ggplot(df, aes(dec_n, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(dec_n, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, dec_n, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=dec_n, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$dec_n)]), ]
```

```{r}
aov_model <- aov(dec_n ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(dec_n ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "dec_n")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('dec_n', 'highlight');});</script>")
}

```







### dec_mean {.tabset .tabset-fade .tabset-pills}
**Среднее замедление**

#### Descriptive stat

```{r}
describeBy(dec_mean ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "dec_mean"
p1 <- ggplot(df, aes(dec_mean, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(dec_mean, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, dec_mean, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=dec_mean, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$dec_mean)]), ]
```

```{r}
aov_model <- aov(dec_mean ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(dec_mean ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "dec_mean")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('dec_mean', 'highlight');});</script>")
}

```







### dec_sd {.tabset .tabset-fade .tabset-pills}
**Стандартное отклонение замедлений**

#### Descriptive stat

```{r}
describeBy(dec_sd ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "dec_sd"
p1 <- ggplot(df, aes(dec_sd, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(dec_sd, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, dec_sd, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=dec_sd, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$dec_sd)]), ]
```

```{r}
aov_model <- aov(dec_sd ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(dec_sd ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "dec_sd")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('dec_sd', 'highlight');});</script>")
}

```







### dec_median {.tabset .tabset-fade .tabset-pills}
**Медианная замедлений**

#### Descriptive stat

```{r}
describeBy(dec_median ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "dec_median"
p1 <- ggplot(df, aes(dec_median, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(dec_median, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, dec_median, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=dec_median, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$dec_median)]), ]
```

```{r}
aov_model <- aov(dec_median ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(dec_median ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "dec_median")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('dec_median', 'highlight');});</script>")
}

```







### dec_trimmed {.tabset .tabset-fade .tabset-pills}
**Усеченное среднее замедлений**

#### Descriptive stat

```{r}
describeBy(dec_trimmed ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "dec_trimmed"
p1 <- ggplot(df, aes(dec_trimmed, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(dec_trimmed, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, dec_trimmed, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=dec_trimmed, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$dec_trimmed)]), ]
```

```{r}
aov_model <- aov(dec_trimmed ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(dec_trimmed ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "dec_trimmed")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('dec_trimmed', 'highlight');});</script>")
}

```







### dec_mad {.tabset .tabset-fade .tabset-pills}
**Среднее абсолютное отклонение замедлений**

#### Descriptive stat

```{r}
describeBy(dec_mad ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "dec_mad"
p1 <- ggplot(df, aes(dec_mad, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(dec_mad, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, dec_mad, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=dec_mad, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$dec_mad)]), ]
```

```{r}
aov_model <- aov(dec_mad ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(dec_mad ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "dec_mad")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('dec_mad', 'highlight');});</script>")
}

```







### dec_min {.tabset .tabset-fade .tabset-pills}
**Минимальное замедление**

#### Descriptive stat

```{r}
describeBy(dec_min ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "dec_min"
p1 <- ggplot(df, aes(dec_min, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(dec_min, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, dec_min, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=dec_min, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$dec_min)]), ]
```

```{r}
aov_model <- aov(dec_min ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(dec_min ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "dec_min")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('dec_min', 'highlight');});</script>")
}

```







### dec_max {.tabset .tabset-fade .tabset-pills}
**Максимальное замедление**

#### Descriptive stat

```{r}
describeBy(dec_max ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "dec_max"
p1 <- ggplot(df, aes(dec_max, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(dec_max, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, dec_max, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=dec_max, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$dec_max)]), ]
```

```{r}
aov_model <- aov(dec_max ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(dec_max ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "dec_max")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('dec_max', 'highlight');});</script>")
}

```







### dec_range {.tabset .tabset-fade .tabset-pills}
**Размах замедлений**

#### Descriptive stat

```{r}
describeBy(dec_range ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "dec_range"
p1 <- ggplot(df, aes(dec_range, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(dec_range, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, dec_range, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=dec_range, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$dec_range)]), ]
```

```{r}
aov_model <- aov(dec_range ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(dec_range ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "dec_range")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('dec_range', 'highlight');});</script>")
}

```







### dec_skew {.tabset .tabset-fade .tabset-pills}
**Коэффициент асимметрии замедлений**

#### Descriptive stat

```{r}
describeBy(dec_skew ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "dec_skew"
p1 <- ggplot(df, aes(dec_skew, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(dec_skew, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, dec_skew, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=dec_skew, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$dec_skew)]), ]
```

```{r}
aov_model <- aov(dec_skew ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(dec_skew ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "dec_skew")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('dec_skew', 'highlight');});</script>")
}

```







### dec_kurtosis {.tabset .tabset-fade .tabset-pills}
**Эксцесс замедлений**

#### Descriptive stat

```{r}
describeBy(dec_kurtosis ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "dec_kurtosis"
p1 <- ggplot(df, aes(dec_kurtosis, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(dec_kurtosis, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, dec_kurtosis, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=dec_kurtosis, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$dec_kurtosis)]), ]
```

```{r}
aov_model <- aov(dec_kurtosis ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(dec_kurtosis ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "dec_kurtosis")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('dec_kurtosis', 'highlight');});</script>")
}

```







### dec_se {.tabset .tabset-fade .tabset-pills}
**Стандартная ошибка замедлений**

#### Descriptive stat

```{r}
describeBy(dec_se ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "dec_se"
p1 <- ggplot(df, aes(dec_se, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(dec_se, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, dec_se, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=dec_se, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$dec_se)]), ]
```

```{r}
aov_model <- aov(dec_se ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(dec_se ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "dec_se")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('dec_se', 'highlight');});</script>")
}

```







### dec_q0.25 {.tabset .tabset-fade .tabset-pills}
**Нижний квартиль замедлений**

#### Descriptive stat

```{r}
describeBy(dec_q0.25 ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "dec_q0.25"
p1 <- ggplot(df, aes(dec_q0.25, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(dec_q0.25, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, dec_q0.25, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=dec_q0.25, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$dec_q0.25)]), ]
```

```{r}
aov_model <- aov(dec_q0.25 ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(dec_q0.25 ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "dec_q0.25")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('dec_q0.25', 'highlight');});</script>")
}

```







### dec_q0.75 {.tabset .tabset-fade .tabset-pills}
**Верхний квартиль замедлений**

#### Descriptive stat

```{r}
describeBy(dec_q0.75 ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "dec_q0.75"
p1 <- ggplot(df, aes(dec_q0.75, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(dec_q0.75, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, dec_q0.75, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=dec_q0.75, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$dec_q0.75)]), ]
```

```{r}
aov_model <- aov(dec_q0.75 ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(dec_q0.75 ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "dec_q0.75")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('dec_q0.75', 'highlight');});</script>")
}

```







### braking_line {.tabset .tabset-fade .tabset-pills}
**Линия резких торможений**

#### Descriptive stat

```{r}
describeBy(braking_line ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "braking_line"
p1 <- ggplot(df, aes(braking_line, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(braking_line, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, braking_line, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=braking_line, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$braking_line)]), ]
```

```{r}
aov_model <- aov(braking_line ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(braking_line ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "braking_line")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('braking_line', 'highlight');});</script>")
}

```







### n_braking {.tabset .tabset-fade .tabset-pills}
**Количество резких торможений**

#### Descriptive stat

```{r}
describeBy(n_braking ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "n_braking"
p1 <- ggplot(df, aes(n_braking, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(n_braking, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, n_braking, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=n_braking, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$n_braking)]), ]
```

```{r}
aov_model <- aov(n_braking ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(n_braking ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "n_braking")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('n_braking', 'highlight');});</script>")
}

```







### acc_per_sec_mean {.tabset .tabset-fade .tabset-pills}
**Среднее количество ускорений за секунду**

#### Descriptive stat

```{r}
describeBy(acc_per_sec_mean ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_per_sec_mean"
p1 <- ggplot(df, aes(acc_per_sec_mean, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(acc_per_sec_mean, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, acc_per_sec_mean, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=acc_per_sec_mean, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$acc_per_sec_mean)]), ]
```

```{r}
aov_model <- aov(acc_per_sec_mean ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(acc_per_sec_mean ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "acc_per_sec_mean")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_per_sec_mean', 'highlight');});</script>")
}

```







### acc_per_sec_sd {.tabset .tabset-fade .tabset-pills}
**Стандартное отклонение количества ускорений за секунду **

#### Descriptive stat

```{r}
describeBy(acc_per_sec_sd ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_per_sec_sd"
p1 <- ggplot(df, aes(acc_per_sec_sd, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(acc_per_sec_sd, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, acc_per_sec_sd, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=acc_per_sec_sd, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$acc_per_sec_sd)]), ]
```

```{r}
aov_model <- aov(acc_per_sec_sd ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(acc_per_sec_sd ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "acc_per_sec_sd")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_per_sec_sd', 'highlight');});</script>")
}

```







### acc_per_sec_median {.tabset .tabset-fade .tabset-pills}
**Медианное количество ускорений за секунду**

#### Descriptive stat

```{r}
describeBy(acc_per_sec_median ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_per_sec_median"
p1 <- ggplot(df, aes(acc_per_sec_median, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(acc_per_sec_median, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, acc_per_sec_median, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=acc_per_sec_median, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$acc_per_sec_median)]), ]
```

```{r}
aov_model <- aov(acc_per_sec_median ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(acc_per_sec_median ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "acc_per_sec_median")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_per_sec_median', 'highlight');});</script>")
}

```







### acc_per_sec_trimmed {.tabset .tabset-fade .tabset-pills}
**Усеченное среднее количества ускорений за секунду**

#### Descriptive stat

```{r}
describeBy(acc_per_sec_trimmed ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_per_sec_trimmed"
p1 <- ggplot(df, aes(acc_per_sec_trimmed, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(acc_per_sec_trimmed, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, acc_per_sec_trimmed, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=acc_per_sec_trimmed, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$acc_per_sec_trimmed)]), ]
```

```{r}
aov_model <- aov(acc_per_sec_trimmed ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(acc_per_sec_trimmed ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "acc_per_sec_trimmed")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_per_sec_trimmed', 'highlight');});</script>")
}

```







### acc_per_sec_mad {.tabset .tabset-fade .tabset-pills}
**Среднее абсолютное отклонение количества ускорений за секунду**

#### Descriptive stat

```{r}
describeBy(acc_per_sec_mad ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_per_sec_mad"
p1 <- ggplot(df, aes(acc_per_sec_mad, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(acc_per_sec_mad, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, acc_per_sec_mad, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=acc_per_sec_mad, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$acc_per_sec_mad)]), ]
```

```{r}
aov_model <- aov(acc_per_sec_mad ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(acc_per_sec_mad ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "acc_per_sec_mad")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_per_sec_mad', 'highlight');});</script>")
}

```







### acc_per_sec_min {.tabset .tabset-fade .tabset-pills}
**Минимальное количество ускорений за секунду**

#### Descriptive stat

```{r}
describeBy(acc_per_sec_min ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_per_sec_min"
p1 <- ggplot(df, aes(acc_per_sec_min, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(acc_per_sec_min, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, acc_per_sec_min, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=acc_per_sec_min, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$acc_per_sec_min)]), ]
```

```{r}
aov_model <- aov(acc_per_sec_min ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(acc_per_sec_min ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "acc_per_sec_min")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_per_sec_min', 'highlight');});</script>")
}

```







### acc_per_sec_max {.tabset .tabset-fade .tabset-pills}
**Максимальное количество ускорений за секунду**

#### Descriptive stat

```{r}
describeBy(acc_per_sec_max ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_per_sec_max"
p1 <- ggplot(df, aes(acc_per_sec_max, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(acc_per_sec_max, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, acc_per_sec_max, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=acc_per_sec_max, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$acc_per_sec_max)]), ]
```

```{r}
aov_model <- aov(acc_per_sec_max ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(acc_per_sec_max ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "acc_per_sec_max")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_per_sec_max', 'highlight');});</script>")
}

```







### acc_per_sec_range {.tabset .tabset-fade .tabset-pills}
**Размах количества ускорений за секунду**

#### Descriptive stat

```{r}
describeBy(acc_per_sec_range ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_per_sec_range"
p1 <- ggplot(df, aes(acc_per_sec_range, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(acc_per_sec_range, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, acc_per_sec_range, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=acc_per_sec_range, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$acc_per_sec_range)]), ]
```

```{r}
aov_model <- aov(acc_per_sec_range ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(acc_per_sec_range ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "acc_per_sec_range")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_per_sec_range', 'highlight');});</script>")
}

```







### acc_per_sec_skew {.tabset .tabset-fade .tabset-pills}
**Коэффициент асимметрии количества ускорений за секунду**

#### Descriptive stat

```{r}
describeBy(acc_per_sec_skew ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_per_sec_skew"
p1 <- ggplot(df, aes(acc_per_sec_skew, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(acc_per_sec_skew, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, acc_per_sec_skew, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=acc_per_sec_skew, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$acc_per_sec_skew)]), ]
```

```{r}
aov_model <- aov(acc_per_sec_skew ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(acc_per_sec_skew ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "acc_per_sec_skew")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_per_sec_skew', 'highlight');});</script>")
}

```







### acc_per_sec_kurtosis {.tabset .tabset-fade .tabset-pills}
**Эксцесс количества ускорений за секунду**

#### Descriptive stat

```{r}
describeBy(acc_per_sec_kurtosis ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_per_sec_kurtosis"
p1 <- ggplot(df, aes(acc_per_sec_kurtosis, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(acc_per_sec_kurtosis, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, acc_per_sec_kurtosis, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=acc_per_sec_kurtosis, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$acc_per_sec_kurtosis)]), ]
```

```{r}
aov_model <- aov(acc_per_sec_kurtosis ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(acc_per_sec_kurtosis ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "acc_per_sec_kurtosis")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_per_sec_kurtosis', 'highlight');});</script>")
}

```







### acc_per_sec_se {.tabset .tabset-fade .tabset-pills}
**Стандартная ошибка количества ускорений за секунду**

#### Descriptive stat

```{r}
describeBy(acc_per_sec_se ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_per_sec_se"
p1 <- ggplot(df, aes(acc_per_sec_se, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(acc_per_sec_se, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, acc_per_sec_se, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=acc_per_sec_se, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$acc_per_sec_se)]), ]
```

```{r}
aov_model <- aov(acc_per_sec_se ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(acc_per_sec_se ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "acc_per_sec_se")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_per_sec_se', 'highlight');});</script>")
}

```







### acc_per_sec_q0.25 {.tabset .tabset-fade .tabset-pills}
**Нижний квартиль количества ускорений за секунду**

#### Descriptive stat

```{r}
describeBy(acc_per_sec_q0.25 ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_per_sec_q0.25"
p1 <- ggplot(df, aes(acc_per_sec_q0.25, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(acc_per_sec_q0.25, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, acc_per_sec_q0.25, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=acc_per_sec_q0.25, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$acc_per_sec_q0.25)]), ]
```

```{r}
aov_model <- aov(acc_per_sec_q0.25 ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(acc_per_sec_q0.25 ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "acc_per_sec_q0.25")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_per_sec_q0.25', 'highlight');});</script>")
}

```







### acc_per_sec_q0.75 {.tabset .tabset-fade .tabset-pills}
**Верхний квартиль количества ускорений за секунду**

#### Descriptive stat

```{r}
describeBy(acc_per_sec_q0.75 ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_per_sec_q0.75"
p1 <- ggplot(df, aes(acc_per_sec_q0.75, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(acc_per_sec_q0.75, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, acc_per_sec_q0.75, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=acc_per_sec_q0.75, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$acc_per_sec_q0.75)]), ]
```

```{r}
aov_model <- aov(acc_per_sec_q0.75 ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(acc_per_sec_q0.75 ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "acc_per_sec_q0.75")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_per_sec_q0.75', 'highlight');});</script>")
}

```







### acc_per_sec_max_pos {.tabset .tabset-fade .tabset-pills}
**Позиция максимального количества ускорений**

#### Descriptive stat

```{r}
describeBy(acc_per_sec_max_pos ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_per_sec_max_pos"
p1 <- ggplot(df, aes(acc_per_sec_max_pos, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(acc_per_sec_max_pos, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, acc_per_sec_max_pos, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=acc_per_sec_max_pos, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$acc_per_sec_max_pos)]), ]
```

```{r}
aov_model <- aov(acc_per_sec_max_pos ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(acc_per_sec_max_pos ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "acc_per_sec_max_pos")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_per_sec_max_pos', 'highlight');});</script>")
}

```







### acc_per_sec_min_pos {.tabset .tabset-fade .tabset-pills}
**Позиция минимального количества ускорений**

#### Descriptive stat

```{r}
describeBy(acc_per_sec_min_pos ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "acc_per_sec_min_pos"
p1 <- ggplot(df, aes(acc_per_sec_min_pos, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(acc_per_sec_min_pos, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, acc_per_sec_min_pos, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=acc_per_sec_min_pos, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$acc_per_sec_min_pos)]), ]
```

```{r}
aov_model <- aov(acc_per_sec_min_pos ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(acc_per_sec_min_pos ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "acc_per_sec_min_pos")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('acc_per_sec_min_pos', 'highlight');});</script>")
}

```







### missings_distance {.tabset .tabset-fade .tabset-pills}
**Расстояние промахов от центра мишеней, пикс.**

#### Descriptive stat

```{r}
describeBy(missings_distance ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "missings_distance"
p1 <- ggplot(df, aes(missings_distance, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(missings_distance, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, missings_distance, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=missings_distance, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$missings_distance)]), ]
```

```{r}
aov_model <- aov(missings_distance ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(missings_distance ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "missings_distance")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('missings_distance', 'highlight');});</script>")
}

```







### missings_mean {.tabset .tabset-fade .tabset-pills}
**Среднее расстояние промахов от центра мишеней, пикс.**

#### Descriptive stat

```{r}
describeBy(missings_mean ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "missings_mean"
p1 <- ggplot(df, aes(missings_mean, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(missings_mean, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, missings_mean, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=missings_mean, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$missings_mean)]), ]
```

```{r}
aov_model <- aov(missings_mean ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(missings_mean ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "missings_mean")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('missings_mean', 'highlight');});</script>")
}

```







### missings_sd {.tabset .tabset-fade .tabset-pills}
**Стандартное отклонение расстояний промахов**

#### Descriptive stat

```{r}
describeBy(missings_sd ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "missings_sd"
p1 <- ggplot(df, aes(missings_sd, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(missings_sd, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, missings_sd, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=missings_sd, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$missings_sd)]), ]
```

```{r}
aov_model <- aov(missings_sd ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(missings_sd ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "missings_sd")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('missings_sd', 'highlight');});</script>")
}

```







### missings_median {.tabset .tabset-fade .tabset-pills}
**Медиана расстояний промахов**

#### Descriptive stat

```{r}
describeBy(missings_median ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "missings_median"
p1 <- ggplot(df, aes(missings_median, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(missings_median, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, missings_median, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=missings_median, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$missings_median)]), ]
```

```{r}
aov_model <- aov(missings_median ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(missings_median ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "missings_median")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('missings_median', 'highlight');});</script>")
}

```







### missings_trimmed {.tabset .tabset-fade .tabset-pills}
**Усеченное среднее расстояний промахов**

#### Descriptive stat

```{r}
describeBy(missings_trimmed ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "missings_trimmed"
p1 <- ggplot(df, aes(missings_trimmed, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(missings_trimmed, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, missings_trimmed, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=missings_trimmed, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$missings_trimmed)]), ]
```

```{r}
aov_model <- aov(missings_trimmed ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(missings_trimmed ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "missings_trimmed")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('missings_trimmed', 'highlight');});</script>")
}

```







### missings_mad {.tabset .tabset-fade .tabset-pills}
**Среднее абсолютное отклонение расстояний промахов**

#### Descriptive stat

```{r}
describeBy(missings_mad ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "missings_mad"
p1 <- ggplot(df, aes(missings_mad, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(missings_mad, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, missings_mad, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=missings_mad, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$missings_mad)]), ]
```

```{r}
aov_model <- aov(missings_mad ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(missings_mad ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "missings_mad")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('missings_mad', 'highlight');});</script>")
}

```







### missings_min {.tabset .tabset-fade .tabset-pills}
**Минимальное расстояние промахов**

#### Descriptive stat

```{r}
describeBy(missings_min ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "missings_min"
p1 <- ggplot(df, aes(missings_min, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(missings_min, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, missings_min, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=missings_min, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$missings_min)]), ]
```

```{r}
aov_model <- aov(missings_min ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(missings_min ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "missings_min")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('missings_min', 'highlight');});</script>")
}

```







### missings_max {.tabset .tabset-fade .tabset-pills}
**Максимальное расстояние промахов**

#### Descriptive stat

```{r}
describeBy(missings_max ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "missings_max"
p1 <- ggplot(df, aes(missings_max, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(missings_max, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, missings_max, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=missings_max, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$missings_max)]), ]
```

```{r}
aov_model <- aov(missings_max ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(missings_max ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "missings_max")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('missings_max', 'highlight');});</script>")
}

```







### missings_range {.tabset .tabset-fade .tabset-pills}
**Размах расстояния промахов**

#### Descriptive stat

```{r}
describeBy(missings_range ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "missings_range"
p1 <- ggplot(df, aes(missings_range, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(missings_range, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, missings_range, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=missings_range, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$missings_range)]), ]
```

```{r}
aov_model <- aov(missings_range ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(missings_range ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "missings_range")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('missings_range', 'highlight');});</script>")
}

```







### missings_skew {.tabset .tabset-fade .tabset-pills}
**Коэффициент асимметрии расстояний промахов**

#### Descriptive stat

```{r}
describeBy(missings_skew ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "missings_skew"
p1 <- ggplot(df, aes(missings_skew, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(missings_skew, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, missings_skew, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=missings_skew, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$missings_skew)]), ]
```

```{r}
aov_model <- aov(missings_skew ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(missings_skew ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "missings_skew")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('missings_skew', 'highlight');});</script>")
}

```







### missings_kurtosis {.tabset .tabset-fade .tabset-pills}
**Эксцесс расстояний промахов**

#### Descriptive stat

```{r}
describeBy(missings_kurtosis ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "missings_kurtosis"
p1 <- ggplot(df, aes(missings_kurtosis, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(missings_kurtosis, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, missings_kurtosis, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=missings_kurtosis, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$missings_kurtosis)]), ]
```

```{r}
aov_model <- aov(missings_kurtosis ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(missings_kurtosis ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "missings_kurtosis")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('missings_kurtosis', 'highlight');});</script>")
}

```







### missings_se {.tabset .tabset-fade .tabset-pills}
**Стандартная ошибка расстояний промахов**

#### Descriptive stat

```{r}
describeBy(missings_se ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "missings_se"
p1 <- ggplot(df, aes(missings_se, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(missings_se, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, missings_se, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=missings_se, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$missings_se)]), ]
```

```{r}
aov_model <- aov(missings_se ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(missings_se ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "missings_se")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('missings_se', 'highlight');});</script>")
}

```







### missings_q0.25 {.tabset .tabset-fade .tabset-pills}
**Нижний квартиль расстояний промахов**

#### Descriptive stat

```{r}
describeBy(missings_q0.25 ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "missings_q0.25"
p1 <- ggplot(df, aes(missings_q0.25, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(missings_q0.25, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, missings_q0.25, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=missings_q0.25, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$missings_q0.25)]), ]
```

```{r}
aov_model <- aov(missings_q0.25 ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(missings_q0.25 ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "missings_q0.25")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('missings_q0.25', 'highlight');});</script>")
}

```







### missings_q0.75 {.tabset .tabset-fade .tabset-pills}
**Верхний квартиль расстояний промахов**

#### Descriptive stat

```{r}
describeBy(missings_q0.75 ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "missings_q0.75"
p1 <- ggplot(df, aes(missings_q0.75, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(missings_q0.75, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, missings_q0.75, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=missings_q0.75, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$missings_q0.75)]), ]
```

```{r}
aov_model <- aov(missings_q0.75 ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(missings_q0.75 ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "missings_q0.75")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('missings_q0.75', 'highlight');});</script>")
}

```







### missings {.tabset .tabset-fade .tabset-pills}
**Количество промахов, шт.**

#### Descriptive stat

```{r}
describeBy(missings ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "missings"
p1 <- ggplot(df, aes(missings, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(missings, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, missings, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=missings, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$missings)]), ]
```

```{r}
aov_model <- aov(missings ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(missings ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "missings")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('missings', 'highlight');});</script>")
}

```







### hits {.tabset .tabset-fade .tabset-pills}
**Количество попаданий, шт.**

#### Descriptive stat

```{r}
describeBy(hits ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "hits"
p1 <- ggplot(df, aes(hits, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(hits, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, hits, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=hits, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$hits)]), ]
```

```{r}
aov_model <- aov(hits ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(hits ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "hits")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('hits', 'highlight');});</script>")
}

```







### missings_trend {.tabset .tabset-fade .tabset-pills}
**Линейный тренд расстояния промахов**

#### Descriptive stat

```{r}
describeBy(missings_trend ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "missings_trend"
p1 <- ggplot(df, aes(missings_trend, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(missings_trend, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, missings_trend, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=missings_trend, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$missings_trend)]), ]
```

```{r}
aov_model <- aov(missings_trend ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(missings_trend ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "missings_trend")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('missings_trend', 'highlight');});</script>")
}

```







### accuracy_rate {.tabset .tabset-fade .tabset-pills}
**Точность, %**

#### Descriptive stat

```{r}
describeBy(accuracy_rate ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "accuracy_rate"
p1 <- ggplot(df, aes(accuracy_rate, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(accuracy_rate, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, accuracy_rate, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=accuracy_rate, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$accuracy_rate)]), ]
```

```{r}
aov_model <- aov(accuracy_rate ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(accuracy_rate ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "accuracy_rate")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('accuracy_rate', 'highlight');});</script>")
}

```







### combo_hits {.tabset .tabset-fade .tabset-pills}
**Комбо попаданий**

#### Descriptive stat

```{r}
describeBy(combo_hits ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "combo_hits"
p1 <- ggplot(df, aes(combo_hits, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(combo_hits, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, combo_hits, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=combo_hits, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$combo_hits)]), ]
```

```{r}
aov_model <- aov(combo_hits ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(combo_hits ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "combo_hits")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('combo_hits', 'highlight');});</script>")
}

```







### combo_missings {.tabset .tabset-fade .tabset-pills}
**Комбо пропахов**

#### Descriptive stat

```{r}
describeBy(combo_missings ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "combo_missings"
p1 <- ggplot(df, aes(combo_missings, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(combo_missings, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, combo_missings, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=combo_missings, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$combo_missings)]), ]
```

```{r}
aov_model <- aov(combo_missings ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(combo_missings ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "combo_missings")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('combo_missings', 'highlight');});</script>")
}

```

















### corr_sat {.tabset .tabset-fade .tabset-pills}
**Коэффициент корреляции скорости и точности**

#### Descriptive stat

```{r}
describeBy(corr_sat ~ gender + stage, data = df, quant = c(0.25, 0.75), mat = T)
```


```{r fig.width=7, fig.height=4, results='asis'}
plot_title <- "corr_sat"
p1 <- ggplot(df, aes(corr_sat, fill=gender)) + 
    geom_histogram() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Hist")

p2 <- ggplot(df, aes(corr_sat, fill=gender)) + 
    geom_density() + 
  facet_wrap("gender ~ stage") +
  labs(title=plot_title, tabname="Density")

p3 <- ggplot(df, aes(stage, corr_sat, fill=gender)) + 
    geom_boxplot() +
  labs(title=plot_title, tabname="Boxplot")


create_tabs(list(p1, p2, p3))
```



#### CI ~ gender

```{r}
pd = position_dodge(0.1)
ggplot(df, aes(x=stage, y=corr_sat, color=gender, group=gender)) +
  stat_summary(fun.data = mean_cl_boot, geom="errorbar", width=0.2, lwd=0.8, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="line", size=1, position=pd) +
  stat_summary(fun.data = mean_cl_boot, geom="point", size=2.5, position = pd, pch = 15)

```


#### ANOVA

```{r}
df <- df[!df$user_id %in% unique(df$user_id[is.na(df$corr_sat)]), ]
```

```{r}
aov_model <- aov(corr_sat ~ gender * stage, data = df)
summary(aov_model)
```

#### Tables of means
```{r}
model.tables(aov_model, "means")
```

```{r}
tukey <- TukeyHSD(aov_model)
tukey
```


#### Post-hoc
```{r}
options(contrasts = c("contr.sum", "contr.poly"))
emm <- emmeans(aov_model, ~ stage + gender)
post_hoc <- data.frame(pairs(emm))
post_hoc[order(post_hoc$p.value),]
```

#### Различия

```{r}
apa_post_hoc(post_hoc)
```

#### ART

```{r}
model <- art(corr_sat ~ stage * gender + Error(user_id/stage), data = df)
```

```{r}
anova_model <- anova(model)
anova_model
```

#### Post-hoc
```{r}
art.con(model, formula = ~ stage * gender)
```

```{r results='asis'}
if (sum(anova_model$`Pr(>F)` <= 0.05) >= 1) {
  sign_differences <- c(sign_differences, "corr_sat")
  cat("<script>document.addEventListener('DOMContentLoaded', function() {addClassToTitle('corr_sat', 'highlight');});</script>")
}

```








### Значимые различия
```{r results='asis'}
cat(paste0('<a href="#', sign_differences, '">', sign_differences, "</a><br>"))
```
